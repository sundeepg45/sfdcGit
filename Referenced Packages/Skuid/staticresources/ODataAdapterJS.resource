/*! Skuid Rockaway 8.11.0 02-06-2016 */
!function(a,b){var c=a.datajs||{},d=a.OData||{};"function"==typeof define&&define.amd?(define("datajs",c),define("OData",d)):(a.datajs=c,a.OData=d),c.version={major:1,minor:1,build:1};var e=function(b){return a.ActiveXObject?new a.ActiveXObject(b):null},f=function(a){return null!==a&&a!==b},g=function(a,b){var c,d;for(c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1},h=function(a,c){return a!==b?a:c},i=function(b){if(1===arguments.length)return void a.setTimeout(b,0);var c=Array.prototype.slice.call(arguments,1);a.setTimeout(function(){b.apply(this,c)},0)},j=function(a,b){for(var c in b)a[c]=b[c];return a},k=function(a,b){if(a){var c,d;for(c=0,d=a.length;d>c;c++)if(b(a[c]))return a[c]}return null},l=function(a){return"[object Array]"===Object.prototype.toString.call(a)},m=function(a){return"[object Date]"===Object.prototype.toString.call(a)},n=function(a){return"object"==typeof a},o=function(a){return parseInt(a,10)},p=function(a,b,c){a.hasOwnProperty(b)&&(a[c]=a[b],delete a[b])},q=function(a){throw a},r=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},s=function(a,c){return a!==b?a:c},t=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,u=["scheme","authority","path","query","fragment"],v=function(a){var b={isAbsolute:!1};if(a){var c=t.exec(a);if(c){var d,e;for(d=0,e=u.length;e>d;d++)c[d+1]&&(b[u[d]]=c[d+1])}b.scheme&&(b.isAbsolute=!0)}return b},w=function(a){return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")},x=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/,y=/%[0-9A-F]{2}/gi,z=function(a){var b=v(a),c=b.scheme,d=b.authority;if(c&&(b.scheme=c.toLowerCase(),d)){var e=x.exec(d);e&&(b.authority="//"+(e[1]?e[1]+"@":"")+e[2].toLowerCase()+(e[3]?":"+e[3]:""))}return a=w(b),a.replace(y,function(a){return a.toLowerCase()})},A=function(a,b){if(!b)return a;var c=v(a);if(c.isAbsolute)return a;var d,e=v(b),f={};return c.authority?(f.authority=c.authority,d=c.path,f.query=c.query):(c.path?(d="/"===c.path.charAt(0)?c.path:B(c.path,e.path),f.query=c.query):(d=e.path,f.query=c.query||e.query),f.authority=e.authority),f.path=C(d),f.scheme=e.scheme,f.fragment=c.fragment,w(f)},B=function(a,b){var c,d="/";return b&&(c=b.lastIndexOf("/"),d=b.substring(0,c),"/"!==d.charAt(d.length-1)&&(d+="/")),d+a},C=function(a){for(var b,c="",d="";a;)0===a.indexOf("..")||0===a.indexOf(".")?a=a.replace(/^\.\.?\/?/g,""):0===a.indexOf("/..")?(a=a.replace(/^\/\..\/?/g,"/"),b=c.lastIndexOf("/"),c=-1===b?"":c.substring(0,b)):0===a.indexOf("/.")?a=a.replace(/^\/\.\/?/g,"/"):(d=a,b=a.indexOf("/",1),-1!==b&&(d=a.substring(0,b)),c+=d,a=a.replace(d,""));return c},D=function(c){var d=[];if(a.atob===b)d=E(c);else for(var e=a.atob(c),f=0;f<e.length;f++)d.push(e.charCodeAt(f));for(var g="",h="0123456789ABCDEF",i=0;i<d.length;i++){var j=d[i];g+=h[j>>4],g+=h[15&j]}return g},E=function(a){for(var b="",c=0;c<a.length;c++){var d=F(a[c]),e="";null!==d&&(e=d.toString(2),b+=G(e))}var f=[],g=parseInt(b.length/8,10);for(c=0;g>c;c++){var h=parseInt(b.substring(8*c,8*(c+1)),2);f.push(h)}return f},F=function(a){var b=a.charCodeAt(0),c=65,d=6;return b>=65&&90>=b?b-c:b>=97&&122>=b?b-c-d:b>=48&&57>=b?b+4:"+"==a?62:"/"==a?63:null},G=function(a){for(;a.length<6;)a="0"+a;return a},H="http://",I=H+"www.w3.org/",J=I+"1999/xhtml",K=I+"2000/xmlns/",L=I+"XML/1998/namespace",M=H+"www.mozilla.org/newlayout/xml/parsererror.xml",N=function(a){var b=/(^\s)|(\s$)/;return b.test(a)},O=function(a){var b=/^\s*$/;return null===a||b.test(a)},P=function(a){for(;null!==a&&1===a.nodeType;){var b=$(a,"space",L);if("preserve"===b)return!0;if("default"===b)break;a=a.parentNode}return!1},Q=function(a){var b=a.nodeName;return"xmlns"==b||0===b.indexOf("xmlns:")},R=function(a,b,c){try{a.setProperty(b,c)}catch(d){}},S=function(){var a=e("Msxml2.DOMDocument.3.0");return a&&(R(a,"ProhibitDTD",!0),R(a,"MaxElementDepth",256),R(a,"AllowDocumentFunction",!1),R(a,"AllowXsltScript",!1)),a},T=function(){try{var a=e("Msxml2.DOMDocument.6.0");return a&&(a.async=!0),a}catch(b){return S()}},U=function(a){var b=T();if(!b)return null;b.loadXML(a);var c=b.parseError;return 0!==c.errorCode&&V(c.reason,c.srcText,a),b},V=function(a,b,c){throw"string"==typeof a&&(a={message:a}),j(a,{srcText:b||"",errorXmlText:c||""})},W=function(b){var c,d=a.DOMParser&&new a.DOMParser;if(!d)return c=U(b),c||V("XML DOM parser not supported"),c;try{c=d.parseFromString(b,"text/xml")}catch(e){V(e,"",b)}var f=c.documentElement,g=f.namespaceURI,h=ia(f);if("parsererror"===h&&g===M){var i=ea(f,M,"sourcetext"),j=i?ka(i):"";V(ha(f)||"",j,b)}if("h3"===h&&g===J||fa(f,J,"h3")){for(var k="",l=[],m=f.firstChild;m;)1===m.nodeType&&(k+=ha(m)||""),l.push(m.nextSibling),m=m.firstChild||l.shift();k+=ha(f)||"",V(k,"",b)}return c},X=function(a,b){return a?a+":"+b:b},Y=function(a,b){if(N(b.data)){var c=_(a,L,"space");c||(c=qa(a.ownerDocument,L,X("xml","space")),pa(a,c)),c.value="preserve"}return a.appendChild(b),a},Z=function(a,b){var c,d,e=a.attributes;for(c=0,d=e.length;d>c;c++)b(e.item(c))},$=function(a,b,c){var d=_(a,b,c);return d?ka(d):null},_=function(a,b,c){var d=a.attributes;return d.getNamedItemNS?d.getNamedItemNS(c||null,b):d.getQualifiedItem(b,c)||null},aa=function(a,b){var c=_(a,"base",L);return(c?A(c.value,b):b)||null},ba=function(a,b){la(a,!1,function(a){return 1===a.nodeType&&b(a),!0})},ca=function(a,b,c){var d,e,f=c.split("/");for(d=0,e=f.length;e>d;d++)a=a&&ea(a,b,f[d]);return a||null},da=function(a,b,c){var d=c.lastIndexOf("/"),e=c.substring(d+1),f=c.substring(0,d),g=f?ca(a,b,f):a;return g?"@"===e.charAt(0)?_(g,e.substring(1),b):ea(g,b,e):null},ea=function(a,b,c){return ga(a,b,c,!1)},fa=function(a,b,c){if(a.getElementsByTagNameNS){var d=a.getElementsByTagNameNS(b,c);return d.length>0?d[0]:null}return ga(a,b,c,!0)},ga=function(a,b,c,d){var e=null;return la(a,d,function(a){if(1===a.nodeType){var d=!b||ja(a)===b,f=!c||ia(a)===c;d&&f&&(e=a)}return null===e}),e},ha=function(a){var c,d=null,e=9===a.nodeType&&a.documentElement?a.documentElement:a,f=e.ownerDocument.preserveWhiteSpace===!1;return la(e,!1,function(a){if(3===a.nodeType||4===a.nodeType){var g=ka(a),h=f||!O(g);h||(c===b&&(c=P(e)),h=c),h&&(d?d+=g:d=g)}return!0}),d},ia=function(a){return a.localName||a.baseName},ja=function(a){return a.namespaceURI||null},ka=function(a){return 1===a.nodeType?ha(a):a.nodeValue},la=function(a,b,c){for(var d=[],e=a.firstChild,f=!0;e&&f;)f=c(e),f&&(b&&e.firstChild&&d.push(e.firstChild),e=e.nextSibling||d.shift())},ma=function(a,b,c){for(var d=a.nextSibling;d;){if(1===d.nodeType){var e=!b||ja(d)===b,f=!c||ia(d)===c;if(e&&f)return d}d=d.nextSibling}return null},na=function(){var b=a.document.implementation;return b&&b.createDocument?b.createDocument(null,null,null):T()},oa=function(a,b){if(!l(b))return pa(a,b);var c,d;for(c=0,d=b.length;d>c;c++)b[c]&&pa(a,b[c]);return a},pa=function(a,b){if(b){if("string"==typeof b)return Y(a,ua(a.ownerDocument,b));2===b.nodeType?a.setAttributeNodeNS?a.setAttributeNodeNS(b):a.setAttributeNode(b):a.appendChild(b)}return a},qa=function(a,c,d,e){var f=a.createAttributeNS&&a.createAttributeNS(c,d)||a.createNode(2,d,c||b);return f.value=e||"",f},ra=function(a,c,d,e){var f=a.createElementNS&&a.createElementNS(c,d)||a.createNode(1,d,c||b);return oa(f,e||[])},sa=function(a,b,c){return qa(a,K,X("xmlns",c),b)},ta=function(a,b){for(var c="<c>"+b+"</c>",d=W(c),e=d.documentElement,f=("importNode"in a?a.importNode(e,!0):e),g=a.createDocumentFragment(),h=f.firstChild;h;)g.appendChild(h),h=h.nextSibling;return g},ua=function(a,b){return a.createTextNode(b)},va=function(a,b,c,d,e){var f,g,h="",i=e.split("/"),j=ea,k=ra,l=b;for(f=0,g=i.length;g>f;f++){h=i[f],"@"===h.charAt(0)&&(h=h.substring(1),j=_,k=qa);var m=j(l,c,h);m||(m=k(a,c,X(d,h)),pa(l,m)),l=m}return l},wa=function(b){var c=a.XMLSerializer;if(c){var d=new c;return d.serializeToString(b)}if(b.xml)return b.xml;throw{message:"XML serialization unsupported"}},xa=function(a){var b,c=a.childNodes,d=c.length;if(0===d)return"";var e=a.ownerDocument,f=e.createDocumentFragment(),g=e.createElement("c");for(f.appendChild(g),b=0;d>b;b++)g.appendChild(c[b]);var h=wa(f);for(h=h.substr(3,h.length-7),b=0;d>b;b++)a.appendChild(g.childNodes[b]);return h},ya=function(a,b,c){return function(){return a[b].apply(a,arguments),c}},za=function(){this._arguments=b,this._done=b,this._fail=b,this._resolved=!1,this._rejected=!1};za.prototype={then:function(a,b){return a&&(this._done?this._done.push(a):this._done=[a]),b&&(this._fail?this._fail.push(b):this._fail=[b]),this._resolved?this.resolve.apply(this,this._arguments):this._rejected&&this.reject.apply(this,this._arguments),this},resolve:function(){if(this._done){var a,c;for(a=0,c=this._done.length;c>a;a++)this._done[a].apply(null,arguments);this._done=b,this._resolved=!1,this._arguments=b}else this._resolved=!0,this._arguments=arguments},reject:function(){if(this._fail){var a,c;for(a=0,c=this._fail.length;c>a;a++)this._fail[a].apply(null,arguments);this._fail=b,this._rejected=!1,this._arguments=b}else this._rejected=!0,this._arguments=arguments},promise:function(){var a={};return a.then=ya(this,"then",a),a}};var Aa=function(){return a.jQuery&&a.jQuery.Deferred?new a.jQuery.Deferred:new za},Ba=function(a,b){var c=(a&&a.__metadata||{}).type;return c||(b?b.type:null)},Ca="Edm.",Da=Ca+"Binary",Ea=Ca+"Boolean",Fa=Ca+"Byte",Ga=Ca+"DateTime",Ha=Ca+"DateTimeOffset",Ia=Ca+"Decimal",Ja=Ca+"Double",Ka=Ca+"Guid",La=Ca+"Int16",Ma=Ca+"Int32",Na=Ca+"Int64",Oa=Ca+"SByte",Pa=Ca+"Single",Qa=Ca+"String",Ra=Ca+"Time",Sa=Ca+"Geography",Ta=Sa+"Point",Ua=Sa+"LineString",Va=Sa+"Polygon",Wa=Sa+"Collection",Xa=Sa+"MultiPolygon",Ya=Sa+"MultiLineString",Za=Sa+"MultiPoint",$a=Ca+"Geometry",_a=$a+"Point",ab=$a+"LineString",bb=$a+"Polygon",cb=$a+"Collection",db=$a+"MultiPolygon",eb=$a+"MultiLineString",fb=$a+"MultiPoint",gb="Point",hb="LineString",ib="Polygon",jb="MultiPoint",kb="MultiLineString",lb="MultiPolygon",mb="GeometryCollection",nb=[Qa,Ma,Na,Ea,Ja,Pa,Ga,Ha,Ra,Ia,Ka,Fa,La,Oa,Da],ob=[$a,_a,ab,bb,cb,db,eb,fb],pb=[Sa,Ta,Ua,Va,Wa,Xa,Ya,Za],qb=function(a,b){if(!a)return null;if(l(a)){var c,d,e;for(c=0,d=a.length;d>c;c++)if(e=qb(a[c],b))return e;return null}return a.dataServices?qb(a.dataServices.schema,b):b(a)},rb=function(a,b){return a=0===a?"":"."+ub(a.toString(),3),b>0&&(""===a&&(a=".000"),a+=ub(b.toString(),4)),a},sb=function(a){if("string"==typeof a)return a;var b=Db(a),c=vb(a.__offset);if(b&&"Z"!==c){a=new Date(a.valueOf());var d=ic(c),e=a.getUTCHours()+d.d*d.h,f=a.getUTCMinutes()+d.d*d.m;a.setUTCHours(e,f)}else b||(c="");var g=a.getUTCFullYear(),h=a.getUTCMonth()+1,i="";0>=g&&(g=-(g-1),i="-");var j=rb(a.getUTCMilliseconds(),a.__ns);return i+ub(g,4)+"-"+ub(h,2)+"-"+ub(a.getUTCDate(),2)+"T"+ub(a.getUTCHours(),2)+":"+ub(a.getUTCMinutes(),2)+":"+ub(a.getUTCSeconds(),2)+j+c},tb=function(a){var b=a.ms,c="";0>b&&(c="-",b=-b);var d=Math.floor(b/864e5);b-=864e5*d;var e=Math.floor(b/36e5);b-=36e5*e;var f=Math.floor(b/6e4);b-=6e4*f;var g=Math.floor(b/1e3);return b-=1e3*g,c+"P"+ub(d,2)+"DT"+ub(e,2)+"H"+ub(f,2)+"M"+ub(g,2)+rb(b,a.ns)+"S"},ub=function(a,b,c){for(var d=a.toString(10);d.length<b;)c?d+="0":d="0"+d;return d},vb=function(a){return a&&"Z"!==a&&"+00:00"!==a&&"-00:00"!==a?a:"Z"},wb=function(a){if("string"==typeof a){var b=a.indexOf(")",10);if(0===a.indexOf("Collection(")&&b>0)return a.substring(11,b)}return null},xb=function(a,c,d,e,f,g){return f.request(a,function(f){try{f.headers&&ac(f.headers),f.data===b&&204!==f.statusCode&&e.read(f,g)}catch(h){return h.request===b&&(h.request=a),h.response===b&&(h.response=f),void d(h)}c(f.data,f)},d)},yb=function(a){return Cb(a)&&l(a.__batchRequests)},zb=/Collection\((.*)\)/,Ab=function(a,b){var c=a&&a.results||a;return!!c&&Bb(b)||!b&&l(c)&&!Cb(c[0])},Bb=function(a){return zb.test(a)},Cb=function(a){return!!a&&n(a)&&!l(a)&&!m(a)},Db=function(a){return"Edm.DateTimeOffset"===a.__edmType||!a.__edmType&&a.__offset},Eb=function(a){if(!a&&!Cb(a))return!1;var b=a.__metadata||{},c=a.__deferred||{};return!b.type&&!!c.uri},Fb=function(a){return Cb(a)&&a.__metadata&&"uri"in a.__metadata},Gb=function(a,b){var c=a&&a.results||a;return l(c)&&!Bb(b)&&Cb(c[0])},Hb=function(a){return g(pb,a)},Ib=function(a){return g(ob,a)},Jb=function(a){if(!a&&!Cb(a))return!1;var b=a.__metadata,c=a.__mediaresource;return!b&&!!c&&!!c.media_src},Kb=function(a){return m(a)||"string"==typeof a||"number"==typeof a||"boolean"==typeof a},Lb=function(a){return g(nb,a)},Mb=function(a,c){return Eb(a)?"deferred":Fb(a)?"entry":Gb(a)?"feed":c&&c.relationship?null!==a&&a!==b&&Gb(a)?"feed":"entry":null},Nb=function(a,b){return k(a,function(a){return a.name===b})},Ob=function(a,b,c){return a?qb(b,function(b){return Zb(a,b,c)}):null},Pb=function(a,b){return k(a,function(a){return a.name===b})},Qb=function(a,b){return Ob(a,b,"complexType")},Rb=function(a,b){return Ob(a,b,"entityType")},Sb=function(a){return qb(a,function(a){return k(a.entityContainer,function(a){return bc(a.isDefaultEntityContainer)})})},Tb=function(a,b){return Ob(a,b,"entityContainer")},Ub=function(a,b){return k(a,function(a){return a.name===b})},Vb=function(a,b){var c=null;if(a){var d=a.relationship,e=qb(b,function(a){var b=Yb(a.namespace,d),c=a.association;if(b&&c){var e,f;for(e=0,f=c.length;f>e;e++)if(c[e].name===b)return c[e]}return null});if(e){var f=e.end[0];f.role!==a.toRole&&(f=e.end[1]),c=f.type}}return c},Wb=function(a,b,c){if(a){var d=a.relationship,e=qb(c,function(a){for(var b=a.entityContainer,c=0;c<b.length;c++){var e=b[c].associationSet;if(e)for(var f=0;f<e.length;f++)if(e[f].association==d)return e[f]}return null});if(e&&e.end[0]&&e.end[1])return e.end[0].entitySet==b?e.end[1].entitySet:e.end[0].entitySet}return null},Xb=function(a,b){var c=qb(b,function(b){for(var c=b.entityContainer,d=0;d<c.length;d++){var e=c[d].entitySet;if(e)for(var f=0;f<e.length;f++)if(e[f].name==a)return{entitySet:e[f],containerName:c[d].name,functionImport:c[d].functionImport}}return null});return c},Yb=function(a,b){return 0===b.indexOf(a)&&"."===b.charAt(a.length)?b.substr(a.length+1):null},Zb=function(a,b,c){if(a&&b){var d=Yb(b.namespace,a);if(d)return k(b[c],function(a){return a.name===d})}return null},$b=function(a,b){if(a===b)return a;for(var c=a.split("."),d=b.split("."),e=c.length>=d.length?c.length:d.length,f=0;e>f;f++){var g=c[f]&&o(c[f]),h=d[f]&&o(d[f]);if(g>h)return a;if(h>g)return b}},_b={accept:"Accept","content-type":"Content-Type",dataserviceversion:"DataServiceVersion",maxdataserviceversion:"MaxDataServiceVersion"},ac=function(a){for(var b in a){var c=b.toLowerCase(),d=_b[c];if(d&&b!==d){var e=a[b];delete a[b],a[d]=e}}},bc=function(a){return"boolean"==typeof a?a:"string"==typeof a&&"true"===a.toLowerCase()},cc=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?(?:\.(\d+))?(.*)$/,dc=function(a,b,c){var d=cc.exec(a),e=d?vb(d[8]):null;if(!d||!b&&"Z"!==e){if(c)return null;throw{message:"Invalid date/time value"}}var f=o(d[1]);0>=f&&f++;var g=d[7],h=0;if(g){if(g.length>7){if(c)return null;throw{message:"Cannot parse date/time value to given precision."}}h=ub(g.substring(3),4,!0),g=ub(g.substring(0,3),3,!0),g=o(g),h=o(h)}else g=0;var i=o(d[4]),j=o(d[5]),k=o(d[6])||0;if("Z"!==e){var l=ic(e),m=-l.d;i+=l.h*m,j+=l.m*m}var n=new Date;if(n.setUTCFullYear(f,o(d[2])-1,o(d[3])),n.setUTCHours(i,j,k,g),isNaN(n.valueOf())){if(c)return null;throw{message:"Invalid date/time value"}}return b&&(n.__edmType="Edm.DateTimeOffset",n.__offset=e),h&&(n.__ns=h),n},ec=function(a,b){return dc(a,!1,b)},fc=function(a,b){return dc(a,!0,b)},gc=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/,hc=function(a){var b=gc.exec(a);if(null===b)throw{message:"Invalid duration value."};var c=b[2]||"0",d=b[3]||"0",e=o(b[4]||0),f=o(b[5]||0),g=o(b[6]||0),h=parseFloat(b[7]||0);if("0"!==c||"0"!==d)throw{message:"Unsupported duration value."};var i=b[8],j=0;if(i){if(i.length>7)throw{message:"Cannot parse duration value to given precision."};j=ub(i.substring(3),4,!0),i=ub(i.substring(0,3),3,!0),i=o(i),j=o(j)}else i=0;i+=1e3*h+6e4*g+36e5*f+864e5*e,"-"===b[1]&&(i=-i);var k={ms:i,__edmType:"Edm.Time"};return j&&(k.ns=j),k},ic=function(a){var b=a.substring(0,1);b="+"===b?1:-1;var c=o(a.substring(1)),d=o(a.substring(a.indexOf(":")+1));return{d:b,h:c,m:d}},jc=function(a,c,d){a.method||(a.method="GET"),a.headers?ac(a.headers):a.headers={},a.headers.Accept===b&&(a.headers.Accept=c.accept),f(a.data)&&a.body===b&&c.write(a,d),f(a.headers.MaxDataServiceVersion)||(a.headers.MaxDataServiceVersion=c.maxDataServiceVersion||"1.0")},kc=function(a,c,d){if(a&&"object"==typeof a)for(var e in a){var f=a[e],g=kc(f,e,d);g=d(e,g,c),g!==f&&(f===b?delete a[e]:a[e]=g)}return a},lc=function(a,b){return b("",kc(a,"",b))},mc=0,nc=function(a){return a.method&&"GET"!==a.method?!1:!0},oc=function(b){var c=a.document.createElement("IFRAME");c.style.display="none";var d=b.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;"),e='<html><head><script type="text/javascript" src="'+d+'"></script></head><body></body></html>',f=a.document.getElementsByTagName("BODY")[0];return f.appendChild(c),vc(c,e),c},pc=function(){if(a.XMLHttpRequest)return new a.XMLHttpRequest;var b;if(a.ActiveXObject)try{return new a.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(c){try{return new a.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(d){b=d}}else b={message:"XMLHttpRequest not supported"};throw b},qc=function(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")||0===a.indexOf("file://")},rc=function(b){if(!qc(b))return!0;var c=a.location,d=c.protocol+"//"+c.host+"/";return 0===b.indexOf(d)},sc=function(c,d){try{delete a[c]}catch(e){a[c]=b,d===mc-1&&(mc-=1)}},tc=function(a){return a&&(vc(a,""),a.parentNode.removeChild(a)),null},uc=function(a,b){var c,d,e=a.getAllResponseHeaders().split(/\r?\n/);for(c=0,d=e.length;d>c;c++)if(e[c]){var f=e[c].split(": ");b[f[0]]=f[1]}},vc=function(a,b){var c=a.contentWindow?a.contentWindow.document:a.contentDocument.document;c.open(),c.write(b),c.close()};d.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:!1,request:function(c,d,e){var f,g={},j=null,k=!1;g.abort=function(){f=tc(f),k||(k=!0,j&&(j.abort(),j=null),e({message:"Request aborted"}))};var l,m=function(){f=tc(f),k||(k=!0,j=null,e({message:"Request timed out"}))},n=c.requestUri,o=h(c.enableJsonpCallback,this.enableJsonpCallback),p=h(c.callbackParameterName,this.callbackParameterName),q=h(c.formatQueryString,this.formatQueryString);if(!o||rc(n)){if(j=pc(),j.onreadystatechange=function(){if(!k&&null!==j&&4===j.readyState){var a=j.statusText,b=j.status;1223===b&&(b=204,a="No Content");var f=[];uc(j,f);var g={requestUri:n,statusCode:b,statusText:a,headers:f,body:j.responseText};k=!0,j=null,b>=200&&299>=b?d(g):e({message:"HTTP request failed",request:c,response:g})}},j.open(c.method||"GET",n,!0,c.user,c.password),c.headers)for(l in c.headers)j.setRequestHeader(l,c.headers[l]);c.timeoutMS&&(j.timeout=c.timeoutMS,j.ontimeout=m),j.send(c.body)}else{if(!nc(c))throw{message:"Request is not local and cannot be done through JSONP."};var r=mc;mc+=1;var s,t=r.toString(),u=!1;l="handleJSONP_"+t,a[l]=function(c){if(f=tc(f),!k){u=!0,a.clearTimeout(s),sc(l,r),a.ActiveXObject&&(c=a.JSON.parse(a.JSON.stringify(c)));var e;e=c.d===b?{"Content-Type":"application/json;odata=minimalmetadata",dataServiceVersion:"3.0"}:{"Content-Type":"application/json"},i(function(){tc(f),d({body:c,statusCode:200,headers:e})})}};var v=c.timeoutMS?c.timeoutMS:12e4;s=a.setTimeout(m,v);var w=p+"=parent."+l;this.formatQueryString&&(w+="&"+q);var x=n.indexOf("?");-1===x?n=n+"?"+w:x===n.length-1?n+=w:n=n+"&"+w,f=oc(n)}return g}};var wc="3.0",xc=function(a){if(!a)return null;var b,c,d=a.split(";"),e={};for(b=1,c=d.length;c>b;b++){var f=d[b].split("=");e[r(f[0])]=f[1]}return{mediaType:r(d[0]),properties:e}},yc=function(a){if(!a)return b;var c,d=a.mediaType;for(c in a.properties)d+=";"+c+"="+a.properties[c];return d},zc=function(a,b,c,d){var e={};return j(e,c),j(e,{contentType:a,dataServiceVersion:b,handler:d}),e},Ac=function(a,b,c){if(a){var d=a.headers;d[b]||(d[b]=c)}},Bc=function(a,b){if(a){var c=a.headers,d=c.DataServiceVersion;c.DataServiceVersion=d?$b(d,b):b}},Cc=function(a,c){var d=a.headers;return d&&d[c]||b},Dc=function(a){return xc(Cc(a,"Content-Type"))},Ec=/^\s?(\d+\.\d+);?.*$/,Fc=function(a){var b=Cc(a,"DataServiceVersion");if(b){var c=Ec.exec(b);if(c&&c.length)return c[1]}},Gc=function(a,b){return a.accept.indexOf(b.mediaType)>=0},Hc=function(a,c,d,e){if(!d||!d.headers)return!1;var g=Dc(d),h=Fc(d)||"",i=d.body;if(!f(i))return!1;if(Gc(a,g)){var j=zc(g,h,e,a);return j.response=d,d.data=c(a,i,j),d.data!==b}return!1},Ic=function(a,c,d,e){if(!d||!d.headers)return!1;var f=Dc(d),g=Fc(d);if(!f||Gc(a,f)){var h=zc(f,g,e,a);if(h.request=d,d.body=c(a,d.data,h),d.body!==b)return Bc(d,h.dataServiceVersion||"1.0"),Ac(d,"Content-Type",yc(h.contentType)),Ac(d,"MaxDataServiceVersion",a.maxDataServiceVersion),!0}return!1},Jc=function(a,b,c,d){return{accept:c,maxDataServiceVersion:d,read:function(b,c){return Hc(this,a,b,c)},write:function(a,c){return Ic(this,b,a,c)}}},Kc=function(a,b){return b},Lc=function(a,c){return f(c)?c.toString():b};d.textHandler=Jc(Kc,Lc,"text/plain",wc);var Mc=H+"www.opengis.net",Nc=Mc+"/gml",Oc=Mc+"/def/crs/EPSG/0/",Pc="gml",Qc=function(a,b,c){var d={type:a};return d[b]=c,d},Rc=function(a){if(l(a)&&a.length>=2){var b=a[0];a[0]=a[1],a[1]=b}return a},Sc=function(a,b,c,d,e,f){var g=Tc(a,c,d,e,f);return Qc(b,"coordinates",g)},Tc=function(a,b,c,d,e){var f=[];return ba(a,function(a){if(ja(a)===Nc){var g=ia(a);if(g!==b)g===c&&ba(a,function(a){if(ja(a)===Nc){var b=d(a,e);b&&f.push(b)}});else{var h=ea(a,Nc);if(h){var i=d(h,e);i&&f.push(i)}}}}),f},Uc=function(a,b){var c=Tc(a,"geometryMember","geometryMembers",gd,b);return Qc(mb,"geometries",c)},Vc=function(a,b){return Qc(hb,"coordinates",_c(a,b))},Wc=function(a,b){return Sc(a,kb,"curveMember","curveMembers",_c,b)},Xc=function(a,b){return Sc(a,jb,"pointMember","pointMembers",ad,b)},Yc=function(a,b){return Sc(a,lb,"surfaceMember","surfaceMembers",cd,b)},Zc=function(a,b){return Qc(gb,"coordinates",ad(a,b))},$c=function(a,b){return Qc(ib,"coordinates",cd(a,b))},_c=function(a,b){var c=[];return ba(a,function(a){var d=ja(a);if(d===Nc){var e=ia(a);return"posList"===e?void(c=ed(a,b)):"pointProperty"===e?void c.push(bd(a,b)):"pos"===e?void c.push(fd(a,b)):void 0}}),c},ad=function(a,b){var c=ea(a,Nc,"pos");return c?fd(c,b):[]},bd=function(a,b){var c=ea(a,Nc,"Point");return c?ad(c,b):[]},cd=function(a,b){var c=[],d=!1;return ba(a,function(a){if(ja(a)===Nc){var e=ia(a);return"exterior"===e?(d=!0,void c.unshift(dd(a,b))):"interior"===e?void c.push(dd(a,b)):void 0}}),!d&&c.length>0&&c.unshift([[]]),c},dd=function(a,b){var c=[];return ba(a,function(a){ja(a)===Nc&&"LinearRing"===ia(a)&&(c=_c(a,b))}),c},ed=function(a,b){var c=fd(a,!1),d=c.length;if(d%2!==0)throw{message:"GML posList element has an uneven number of numeric values"};for(var e=[],f=0;d>f;f+=2){var g=c.slice(f,f+2);e.push(b?Rc(g):g)}return e},fd=function(a,b){var c=[],d=" 	\r\n",e=ha(a);if(e)for(var f=e.length,g=0,h=0;f>=h;){if(-1!==d.indexOf(e.charAt(h))){var i=e.substring(g,h);i&&c.push(parseFloat(i)),g=h+1}h++}return b?Rc(c):c},gd=function(a,b){var c,d=ia(a);switch(d){case"Point":c=Zc;break;case"Polygon":c=$c;break;case"LineString":c=Vc;break;case"MultiPoint":c=Xc;break;case"MultiCurve":c=Wc;break;case"MultiSurface":c=Yc;break;case"MultiGeometry":c=Uc;break;default:throw{message:"Unsupported element: "+d,element:a}}var e=c(a,b),f=$(a,"srsName",Nc)||$(a,"srsName");if(f){if(0!==f.indexOf(Oc))throw{message:"Unsupported srs name: "+f,element:a};var g=f.substring(Oc.length);g&&(e.crs={type:"name",properties:{name:"EPSG:"+g}})}return e},hd=function(a,b,c,d){var e;switch(c){case gb:e=pd;break;case hb:e=qd;break;case ib:e=rd;break;case jb:e=td;break;case kb:e=ud;break;case lb:e=vd;break;case mb:e=xd;break;default:return null}var f=e(a,b,d),g=b.crs;if(g&&"name"===g.type){var h=g.properties,i=h&&h.name;if(i&&0===i.indexOf("ESPG:")&&i.length>5){var j=i.substring(5),k=qa(a,null,"srsName",Pc+j);pa(f,k)}}return f},id=function(a,b,c){return ra(a,Nc,X(Pc,b),c)},jd=function(a,b,c){var d=l(b)?b:[];return d=c?Rc(d):d,id(a,"pos",d.join(" "))},kd=function(a,b,c,d){var e=id(a,b);if(l(c)){var f,g;for(f=0,g=c.length;g>f;f++)pa(e,jd(a,c[f],d));0===g&&pa(e,id(a,"posList"))}return e},ld=function(a,b,c){return id(a,"Point",jd(a,b,c))},md=function(a,b,c){return kd(a,"LineString",b,c)},nd=function(a,b,c,d){var e=id(a,b);if(l(c)&&c.length>0){var f=kd(a,"LinearRing",c,d);pa(e,f)}return e},od=function(a,b,c){var d=b&&b.length,e=id(a,"Polygon");if(l(b)&&d>0){pa(e,nd(a,"exterior",b[0],c));var f;for(f=1;d>f;f++)pa(e,nd(a,"interior",b[f],c))}return e},pd=function(a,b,c){return ld(a,b.coordinates,c)},qd=function(a,b,c){return md(a,b.coordinates,c)},rd=function(a,b,c){return od(a,b.coordinates,c)},sd=function(a,b,c,d,e,f){var g=d&&d.length,h=id(a,b);if(l(d)&&g>0){var i,j=id(a,c);for(i=0;g>i;i++)pa(j,e(a,d[i],f));pa(h,j)}return h},td=function(a,b,c){return sd(a,"MultiPoint","pointMembers",b.coordinates,ld,c)},ud=function(a,b,c){return sd(a,"MultiCurve","curveMembers",b.coordinates,md,c)},vd=function(a,b,c){return sd(a,"MultiSurface","surfaceMembers",b.coordinates,od,c)},wd=function(a,b,c){return hd(a,b,b.type,c)},xd=function(a,b,c){return sd(a,"MultiGeometry","geometryMembers",b.geometries,wd,c)},yd="application/xml",zd=H+"schemas.microsoft.com/ado/",Ad=zd+"2007/08/dataservices",Bd=zd+"2007/06/edmx",Cd=zd+"2006/04/edm",Dd=zd+"2007/05/edm",Ed=zd+"2008/01/edm",Fd=zd+"2008/09/edm",Gd=zd+"2009/08/edm",Hd=zd+"2009/11/edm",Id=Ad,Jd=Ad+"/metadata",Kd=Ad+"/related/",Ld=Ad+"/scheme",Md="d",Nd="m",Od=function(a,b){var c={name:ia(a),value:a.value};return c[b?"namespaceURI":"namespace"]=ja(a),c},Pd=function(a,b){var c,d,e=[],f=[],g=a.attributes;for(c=0,d=g.length;d>c;c++){var h=g[c];ja(h)!==K&&e.push(Od(h,b))}for(var i=a.firstChild;null!=i;)1===i.nodeType&&f.push(Pd(i,b)),i=i.nextSibling;var j={name:ia(a),value:ha(a),attributes:e,children:f};return j[b?"namespaceURI":"namespace"]=ja(a),j},Qd=function(a){return ja(a)===Id&&"element"===ia(a)},Rd=function(a,b){return{type:a,extensions:b}},Sd=function(a){if(ea(a,Nc))return $a;var b=ea(a,Id);if(!b)return Qa;if(Qd(b)){var c=ma(b,Id);if(c&&Qd(c))return"Collection()"}return null},Td=function(a){var b=null,c=!1,d=[];return Z(a,function(a){var e=ja(a),f=ia(a),g=ka(a);if(e===Jd){if("null"===f)return void(c="true"===g.toLowerCase());if("type"===f)return void(b=g)}return e!==L&&e!==K?void d.push(Od(a,!0)):void 0}),{type:!b&&c?Qa:b,isNull:c,extensions:d}},Ud=function(a){if(ja(a)!==Id)return null;var b=ia(a),c=Td(a),d=c.isNull,e=c.type,f=Rd(e,c.extensions),g=d?null:Vd(a,e,f);return{name:b,value:g,metadata:f}},Vd=function(a,b,c){b||(b=Sd(a),c.type=b);var d=Hb(b);return d||Ib(b)?Wd(a,b,d):Lb(b)?Xd(a,b):Bb(b)?Zd(a,b,c):Yd(a,b,c)},Wd=function(a,b,c){var d=ea(a,Nc),e=gd(d,c);return e.__metadata={type:b},e},Xd=function(a,b){var c=ka(a)||"";switch(b){case Ea:return bc(c);case Da:case Ia:case Ka:case Na:case Qa:return c;case Fa:case La:case Ma:case Oa:return o(c);case Ja:case Pa:return parseFloat(c);case Ra:return hc(c);case Ga:return ec(c);case Ha:return fc(c)}return c},Yd=function(a,b,c){var d={__metadata:{type:b}};return ba(a,function(a){var b=Ud(a),e=b.name;c.properties=c.properties||{},c.properties[e]=b.metadata,d[e]=b.value}),d},Zd=function(a,b,c){var d=[],e=c.elements=[],f=wb(b);return ba(a,function(a){if(Qd(a)){var b=Td(a),c=b.extensions,g=b.type||f,h=Rd(g,c),i=Vd(a,g,h);d.push(i),e.push(h)}}),{__metadata:{type:"Collection()"===b?null:b},results:d}},$d=function(a,c){if(ja(a)===Id){c=aa(a,c);var d=ia(a);if("links"===d)return _d(a,c);if("uri"===d)return ae(a,c)}return b},_d=function(a,b){var c=[];return ba(a,function(a){"uri"===ia(a)&&ja(a)===Id&&c.push(ae(a,b))}),{results:c}},ae=function(a,b){var c=ha(a)||"";return{uri:A(c,b)}},be=function(a,b){return b===$a||b===Sa?a&&a.type:b===_a||b===Ta?gb:b===ab||b===Ua?hb:b===bb||b===Va?ib:b===cb||b===Wa?mb:b===db||b===Xa?lb:b===eb||b===Ya?kb:b===fb||b===Za?jb:null},ce=function(a,b,c){return ra(a,Jd,X(Nd,b),c)},de=function(a,b,c){return qa(a,Jd,X(Nd,b),c)},ee=function(a,b,c){return ra(a,Id,X(Md,b),c)},fe=function(a,b){return b===Ga||b===Ha||m(a)?sb(a):b===Ra?tb(a):a.toString()},ge=function(a,b){return{element:a,dsv:b}},he=function(a,b,c,d){var e=c?de(a,"type",c):null,f=ee(a,b,e);return oa(f,d)},ie=function(a,b,c,d){var e=fe(c,d),f=he(a,b,d,e);return ge(f,"1.0")},je=function(a,b,c,d){var e=de(a,"null","true"),f=he(a,b,c,e),g=Qb(c,d)?"2.0":"1.0";return ge(f,g)},ke=function(a,b,c,d,e,f,g){var h=wb(d),i=l(c)?c:c.results,j=d?{type:h}:{};j.properties=e.properties;var k,m,n=he(a,b,h?d:null);for(k=0,m=i.length;m>k;k++){var o=i[k],p=ne(a,"element",o,j,f,g);pa(n,p.element)}return ge(n,"3.0")},le=function(a,b,c,d,e,f,g){var h=he(a,b,d),i=e.properties||{},j=Qb(d,g)||{},k="1.0";for(var l in c)if("__metadata"!==l){var m=c[l],n=Nb(j.property,l),o=i[l]||{},p=ne(a,l,m,o,n,g);k=$b(k,p.dsv),pa(h,p.element)}return ge(h,k)},me=function(a,b,c,d,e){var f=be(c,d),g=hd(a,c,f,e),h=he(a,b,d,g);return ge(h,"3.0")},ne=function(a,b,c,d,e,f){var g=Ba(c,d,e);if(Kb(c))return ie(a,b,c,g||Qa);var h=Hb(g);if(h||Ib(g))return me(a,b,c,g,h);if(Ab(c,g))return ke(a,b,c,g,d,e,f);if(Jb(c))return null;var i=Mb(c,e);return null!==i?null:null===c?je(a,b,g):le(a,b,c,g,d,e,f)},oe=function(a){if(a&&n(a)){var b=na();return pa(b,ee(b,"uri",a.uri))}},pe=function(a,b){if(b){var c=W(b),d=ea(c);if(d)return $d(d)}},qe=function(a,c,d){var e=d.contentType=d.contentType||xc(yd);return e&&e.mediaType===yd?wa(oe(c)):b};d.xmlHandler=Jc(pe,qe,yd,wc);var re="a",se=I+"2005/Atom",te=I+"2007/app",ue=Ad+"/edit-media/",ve=Ad+"/mediaresource/",we=Ad+"/relatedlinks/",xe=["application/atom+xml","application/atomsvc+xml","application/xml"],ye=xe[0],ze=[se,te,L,K],Ae={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},Be=function(a){return Ae[a]||a},Ce=function(a){return!g(ze,a)},De=function(a,b,c,d,e){e=e||"";var f=a["FC_TargetPath"+e];if(!f)return null;var g=a["FC_SourcePath"+e],h=Be(f),i=d?d+(g?"/"+g:""):g,j=i&&Re(c,b,i),k=a["FC_NsUri"+e]||null,l=a["FC_NsPrefix"+e]||null,m=a["FC_KeepInContent"+e]||"";return f!==h&&(k=se,l=re),{contentKind:a["FC_ContentKind"+e],keepInContent:"true"===m.toLowerCase(),nsPrefix:l,nsURI:k,propertyPath:i,propertyType:j,entryPath:h}},Ee=function(a,b,c){for(var d=[];a;){var e=(a.FC_SourcePath,De(a,a,b));e&&c(e);var f,g,h=a.property||[];for(f=0,g=h.length;g>f;f++)for(var i=h[f],j=0,k="";e=De(i,a,b,i.name,k);)c(e),j++,k="_"+j;a=Rb(a.baseType,b)}return d},Fe=function(a){var b=[];return Z(a,function(a){var c=ja(a);Ce(c)&&b.push(Od(a,!0))}),b},Ge=function(a){return Pd(a,!0)},He=function(a,b,c){var d=ja(a),e=ia(a);if(d===te&&"service"===e)return cf(a,b);if(d===se){if("feed"===e)return Le(a,b,c);if("entry"===e)return Se(a,b,c)}},Ie=function(a,b){var c=[],d={extensions:c};return Z(a,function(e){var f=ia(e),g=ja(e),h=ka(e);if(null===g){if("title"===f||"metadata"===f)return void(d[f]=h);if("target"===f)return void(d.target=A(h,aa(a,b)))}Ce(g)&&c.push(Od(e,!0))}),d},Je=function(a,b,c){var d=c.actions=c.actions||[];d.push(Ie(a,b))},Ke=function(a,b,c){var d=c.functions=c.functions||[];d.push(Ie(a,b))},Le=function(a,b,c){var d=Fe(a),e={feed_extensions:d},f=[],g={__metadata:e,results:f};return b=aa(a,b),ba(a,function(a){var h=ja(a),i=ia(a);if(h===Jd){if("count"===i)return void(g.__count=parseInt(ha(a),10));if("action"===i)return void Je(a,b,e);if("function"===i)return void Ke(a,b,e)}return Ce(h)?void d.push(Pd(a)):"entry"===i?void f.push(Se(a,b,c)):"link"===i?void Me(a,g,b):"id"===i?(e.uri=A(ha(a),b),void(e.uri_extensions=Fe(a))):"title"===i?(e.title=ha(a)||"",void(e.title_extensions=Fe(a))):void 0;
}),g},Me=function(a,b,c){var d=Ne(a,c),e=d.href,f=d.rel,g=d.extensions,h=b.__metadata;return"next"===f?(b.__next=e,void(h.next_extensions=g)):"self"===f?(h.self=e,void(h.self_extensions=g)):void 0},Ne=function(a,b){b=aa(a,b);var c=[],d={extensions:c,baseURI:b};if(Z(a,function(a){var e=ja(a),f=ia(a),g=a.value;return"href"===f?void(d.href=A(g,b)):"type"===f||"rel"===f?void(d[f]=g):void(Ce(e)&&c.push(Od(a,!0)))}),!d.href)throw{error:"href attribute missing on link element",element:a};return d},Oe=function(a,c){if(-1===a.indexOf("/"))return c[a];var d,e,f=a.split("/");for(d=0,e=f.length;e>d;d++){if(null===c)return b;if(c=c[f[d]],c===b)return c}return c},Pe=function(a,c,d,e){var f;if(-1===a.indexOf("/"))c[a]=d,f=a;else{var g,h,i=a.split("/");for(g=0,h=i.length-1;h>g;g++){var j=c[i[g]];if(j===b)j={},c[i[g]]=j;else if(null===j)return;c=j}f=i[g],c[f]=d}if(e){var k=c.__metadata=c.__metadata||{},l=k.properties=k.properties||{},m=l[f]=l[f]||{};m.type=e}},Qe=function(a,b,c){var d=a.propertyPath;if(!a.keepInContent&&null!==Oe(d,c)){var e=da(b,a.nsURI,a.entryPath);if(e){var f,g=a.propertyType;f="xhtml"===a.contentKind?xa(e):Xd(e,g||"Edm.String"),Pe(d,c,f,g)}}},Re=function(a,b,c){for(var d,e,f=c.split("/");b;){var g=b;for(d=0,e=f.length;e>d;d++){var h=g.property;if(!h)break;var i=Nb(h,f[d]);if(!i)break;var j=i.type;if(!j||Lb(j))return j||null;if(g=Qb(j,a),!g)return null}b=Rb(b.baseType,a)}return null},Se=function(a,b,c){var d={},e={__metadata:d},f=$(a,"etag",Jd);f&&(d.etag=f),b=aa(a,b),ba(a,function(a){var f=ja(a),g=ia(a);if(f!==se){if(f===Jd){if("properties"===g)return void bf(a,e,d);if("action"===g)return void Je(a,b,d);if("function"===g)return void Ke(a,b,d)}}else{if("id"===g)return void Te(a,d,b);if("category"===g)return void Ue(a,d);if("content"===g)return void Ve(a,e,d,b);if("link"===g)return void We(a,e,d,b,c)}});var g=Rb(d.type,c);return Ee(g,c,function(b){Qe(b,a,e)}),e},Te=function(a,b,c){b.uri=A(ha(a),aa(a,c)),b.uri_extensions=Fe(a)},Ue=function(a,b){if($(a,"scheme")===Ld){if(b.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:a};var c=[];Z(a,function(a){var b=ja(a),d=ia(a);return b?void(Ce(b)&&c.push(Od(a,!0))):void("scheme"!==d&&"term"!==d&&c.push(Od(a,!0)))}),b.type=$(a,"term"),b.type_extensions=c}},Ve=function(a,b,c,d){var e=$(a,"src"),f=$(a,"type");if(e){if(!f)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:a};c.media_src=A(e,aa(a,d)),c.content_type=f}ba(a,function(d){if(e)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:a};ja(d)===Jd&&"properties"===ia(d)&&bf(d,b,c)})},We=function(a,b,c,d,e){var f=Ne(a,d),g=f.rel,h=f.href,i=f.extensions;return"self"===g?(c.self=h,void(c.self_link_extensions=i)):"edit"===g?(c.edit=h,void(c.edit_link_extensions=i)):"edit-media"===g?(c.edit_media=f.href,c.edit_media_extensions=i,void af(f,c)):0===g.indexOf(ue)?void Ze(f,b,c):0===g.indexOf(ve)?void $e(f,b,c):0===g.indexOf(Kd)?void Ye(a,f,b,c,e):0===g.indexOf(we)?void Xe(f,c):void 0},Xe=function(a,b){var c=a.rel.substring(we.length);b.properties=b.properties||{};var d=b.properties[c]=b.properties[c]||{};d.associationuri=a.href,d.associationuri_extensions=a.extensions},Ye=function(a,b,c,d,e){var f,g=ea(a,Jd,"inline");if(g){var h=ea(g),i=aa(g,b.baseURI);f=h?He(h,i,e):null}else f={__deferred:{uri:b.href}};var j=b.rel.substring(Kd.length);c[j]=f,d.properties=d.properties||{};var k=d.properties[j]=d.properties[j]||{};k.extensions=b.extensions},Ze=function(a,b,c){var d=a.rel.substring(ue.length),e=_e(d,b,c),f=e.value,g=e.metadata,h=a.href;f.edit_media=h,f.content_type=a.type,g.edit_media_extensions=a.extensions,f.media_src=f.media_src||h,g.media_src_extensions=g.media_src_extensions||[],af(a,f)},$e=function(a,b,c){var d=a.rel.substring(ve.length),e=_e(d,b,c),f=e.value,g=e.metadata;f.media_src=a.href,g.media_src_extensions=a.extensions,f.content_type=a.type},_e=function(a,b,c){c.properties=c.properties||{};var d=c.properties[a],e=b[a]&&b[a].__mediaresource;return e||(e={},b[a]={__mediaresource:e},c.properties[a]=d={}),{value:e,metadata:d}},af=function(a,b){var c,d,e=a.extensions;for(c=0,d=e.length;d>c;c++)if(e[c].namespaceURI===Jd&&"etag"===e[c].name)return b.media_etag=e[c].value,void e.splice(c,1)},bf=function(a,b,c){ba(a,function(a){var d=Ud(a);if(d){var e=d.name,f=c.properties=c.properties||{};f[e]=d.metadata,b[e]=d.value}})},cf=function(a,b){var c=[],d=[];if(b=aa(a,b),ba(a,function(a){return ja(a)===te&&"workspace"===ia(a)?void c.push(df(a,b)):void d.push(Pd(a))}),0===c.length)throw{message:"Invalid AtomPub service document: No workspace element found.",element:a};return{workspaces:c,extensions:d}},df=function(a,c){var d,e=[],f=[];return c=aa(a,c),ba(a,function(a){var g=ja(a),h=ia(a);if(g===se&&"title"===h){if(d!==b)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:a};return void(d=ha(a))}return g===te?void("collection"===h&&e.push(ef(a,c))):void f.push(Ge(a))}),{title:d||"",collections:e,extensions:f}},ef=function(a,c){var d=$(a,"href");if(!d)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:a};c=aa(a,c),d=A(d,aa(a,c));var e,f=[];if(ba(a,function(c){var d=ja(c),g=ia(c);if(d!==se)d!==te&&f.push(Ge(a));else if("title"===g){if(e!==b)throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:c};e=ha(c)}}),!e)throw{message:"Invalid AtomPub service document: collection has no title element",element:a};return{title:e,href:d,extensions:f}},ff=function(a,b,c){return ra(a,se,X(re,b),c)},gf=function(a,b,c){return qa(a,null,b,c)},hf=function(a){if(a.childNodes.length>0)return!1;var b,c,d=!0,e=a.attributes;for(b=0,c=e.length;c>b&&d;b++){var f=e[b];d=d&&Q(f)||ja(f)==Jd&&"type"===ia(f)}return d},jf=function(a,b,c,d,e){var f=null,g=null,h=null,i="";"deferred"!==c?(f=gf(a,"type","application/atom+xml;type="+c),g=ce(a,"inline"),d&&(i=d.__metadata&&d.__metadata.uri||"",h=nf(a,d,e)||mf(a,d,e),pa(g,h.element))):i=d.__deferred.uri;var j=ff(a,"link",[gf(a,"href",i),gf(a,"rel",A(b,Kd)),f,g]);return ge(j,h?h.dsv:"1.0")},kf=function(a,b,c,d,e,f){if(Jb(c))return null;var g=ne(a,b,c,d,e,f);if(!g){var h=Mb(c,e);g=jf(a,b,h,c,f)}return g},lf=function(a,b,c,d){var e,f=ca(c,Id,d.propertyPath),g=f&&_(f,"null",Jd),h="1.0";if(g&&"true"===g.value)return h;if(f&&(e=ha(f)||"",!d.keepInContent)){h="2.0";var i=f.parentNode,j=i;for(i.removeChild(f);j!==c&&hf(j);)i=j.parentNode,i.removeChild(j),j=i}var k=va(a,b,d.nsURI,d.nsPrefix,d.entryPath);if(2===k.nodeType)return k.value=e,h;var l=d.contentKind;return oa(k,[l&&qa(a,null,"type",l),"xhtml"===l?ta(a,e):e]),h},mf=function(a,b,c){var d=b.__metadata||{},e=d.properties||{},f=d.etag,g=d.uri,h=d.type,i=Rb(h,c),j=ce(a,"properties"),k=ff(a,"entry",[ff(a,"author",ff(a,"name")),f&&de(a,"etag",f),g&&ff(a,"id",g),h&&ff(a,"category",[gf(a,"term",h),gf(a,"scheme",Ld)]),ff(a,"content",[gf(a,"type","application/xml"),j])]),l="1.0";for(var m in b)if("__metadata"!==m){var n=e[m]||{},o=i&&(Nb(i.property,m)||Nb(i.navigationProperty,m)),p=kf(a,m,b[m],n,o,c);if(p){var q=p.element,r=ja(q)===se?k:j;pa(r,q),l=$b(l,p.dsv)}}return Ee(i,c,function(b){var c=lf(a,k,j,b);l=$b(l,c)}),ge(k,l)},nf=function(a,b,c){var d=l(b)?b:b.results;if(!d)return null;var e,f,g="1.0",h=ff(a,"feed");for(e=0,f=d.length;f>e;e++){var i=mf(a,d[e],c);pa(h,i.element),g=$b(g,i.dsv)}return ge(h,g)},of=function(a,b){if(a){var c=Gb(a)&&nf||n(a)&&mf;if(c){var d=na(),e=c(d,a,b);if(e){var f=e.element;return oa(f,[sa(d,Jd,Nd),sa(d,Id,Md)]),ge(pa(d,f),e.dsv)}}}return null},pf=function(a,b,c){if(b){var d=W(b),e=ea(d);if(e)return He(e,null,c.metadata)}},qf=function(a,b,c){var d=c.contentType=c.contentType||xc(ye);if(d&&d.mediaType===ye){var e=of(b,c.metadata);if(e)return c.dataServiceVersion=$b(c.dataServiceVersion||"1.0",e.dsv),wa(e.element)}};d.atomHandler=Jc(pf,qf,xe.join(","),wc);var rf=function(a,b,c,d){return{attributes:a,elements:b,text:c||!1,ns:d}},sf={elements:{Annotations:rf(["Target","Qualifier"],["TypeAnnotation*","ValueAnnotation*"]),Association:rf(["Name"],["End*","ReferentialConstraint","TypeAnnotation*","ValueAnnotation*"]),AssociationSet:rf(["Name","Association"],["End*","TypeAnnotation*","ValueAnnotation*"]),Binary:rf(null,null,!0),Bool:rf(null,null,!0),Collection:rf(null,["String*","Int*","Float*","Decimal*","Bool*","DateTime*","DateTimeOffset*","Guid*","Binary*","Time*","Collection*","Record*"]),CollectionType:rf(["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"],["CollectionType","ReferenceType","RowType","TypeRef"]),ComplexType:rf(["Name","BaseType","Abstract"],["Property*","TypeAnnotation*","ValueAnnotation*"]),DateTime:rf(null,null,!0),DateTimeOffset:rf(null,null,!0),Decimal:rf(null,null,!0),DefiningExpression:rf(null,null,!0),Dependent:rf(["Role"],["PropertyRef*"]),Documentation:rf(null,null,!0),End:rf(["Type","Role","Multiplicity","EntitySet"],["OnDelete"]),EntityContainer:rf(["Name","Extends"],["EntitySet*","AssociationSet*","FunctionImport*","TypeAnnotation*","ValueAnnotation*"]),EntitySet:rf(["Name","EntityType"],["TypeAnnotation*","ValueAnnotation*"]),EntityType:rf(["Name","BaseType","Abstract","OpenType"],["Key","Property*","NavigationProperty*","TypeAnnotation*","ValueAnnotation*"]),EnumType:rf(["Name","UnderlyingType","IsFlags"],["Member*"]),Float:rf(null,null,!0),Function:rf(["Name","ReturnType"],["Parameter*","DefiningExpression","ReturnType","TypeAnnotation*","ValueAnnotation*"]),FunctionImport:rf(["Name","ReturnType","EntitySet","IsSideEffecting","IsComposable","IsBindable","EntitySetPath"],["Parameter*","ReturnType","TypeAnnotation*","ValueAnnotation*"]),Guid:rf(null,null,!0),Int:rf(null,null,!0),Key:rf(null,["PropertyRef*"]),LabeledElement:rf(["Name"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),Member:rf(["Name","Value"]),NavigationProperty:rf(["Name","Relationship","ToRole","FromRole","ContainsTarget"],["TypeAnnotation*","ValueAnnotation*"]),Null:rf(null,null),OnDelete:rf(["Action"]),Path:rf(null,null,!0),Parameter:rf(["Name","Type","Mode","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","SRID"],["CollectionType","ReferenceType","RowType","TypeRef","TypeAnnotation*","ValueAnnotation*"]),Principal:rf(["Role"],["PropertyRef*"]),Property:rf(["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","CollectionKind","SRID"],["CollectionType","ReferenceType","RowType","TypeAnnotation*","ValueAnnotation*"]),PropertyRef:rf(["Name"]),PropertyValue:rf(["Property","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ReferenceType:rf(["Type"]),ReferentialConstraint:rf(null,["Principal","Dependent"]),ReturnType:rf(["ReturnType","Type","EntitySet"],["CollectionType","ReferenceType","RowType"]),RowType:rf(["Property*"]),String:rf(null,null,!0),Schema:rf(["Namespace","Alias"],["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*","ValueTerm*","Annotations*"]),Time:rf(null,null,!0),TypeAnnotation:rf(["Term","Qualifier"],["PropertyValue*"]),TypeRef:rf(["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"]),Using:rf(["Namespace","Alias"]),ValueAnnotation:rf(["Term","Qualifier","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ValueTerm:rf(["Name","Type"],["TypeAnnotation*","ValueAnnotation*"]),Edmx:rf(["Version"],["DataServices","Reference*","AnnotationsReference*"],!1,Bd),DataServices:rf(null,["Schema*"],!1,Bd)}},tf=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];sf.elements.Property.attributes=sf.elements.Property.attributes.concat(tf),sf.elements.EntityType.attributes=sf.elements.EntityType.attributes.concat(tf),sf.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:Bd},sf.elements.DataServices={elements:["Schema*"],ns:Bd},sf.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer"),sf.elements.Property.attributes.push("m:MimeType"),sf.elements.FunctionImport.attributes.push("m:HttpMethod"),sf.elements.FunctionImport.attributes.push("m:IsAlwaysBindable"),sf.elements.EntityType.attributes.push("m:HasStream"),sf.elements.DataServices.attributes=["m:DataServiceVersion","m:MaxDataServiceVersion"];var uf=function(a){if(!a)return a;if(a.length>1){var b=a.substr(0,2);return b===b.toUpperCase()?a:a.charAt(0).toLowerCase()+a.substr(1)}return a.charAt(0).toLowerCase()},vf=function(a,b){if("Documentation"===b)return{isArray:!0,propertyName:"documentation"};var c=a.elements;if(!c)return null;var d,e;for(d=0,e=c.length;e>d;d++){var f=c[d],g=!1;if("*"===f.charAt(f.length-1)&&(g=!0,f=f.substr(0,f.length-1)),b===f){var h=uf(f);return{isArray:g,propertyName:h}}}return null},wf=/^(m:FC_.*)_[0-9]+$/,xf=function(a){return a===Cd||a===Dd||a===Ed||a===Fd||a===Gd||a===Hd},yf=function(a){var b=ia(a),c=ja(a),d=sf.elements[b];if(!d)return null;if(d.ns){if(c!==d.ns)return null}else if(!xf(c))return null;var e={},f=[],h=d.attributes||[];return Z(a,function(a){var b=ia(a),c=ja(a),d=a.value;if(c!==K){var i=null,j=!1;if(xf(c)||null===c?i="":c===Jd&&(i="m:"),null!==i){i+=b;var k=wf.exec(i);k&&(i=k[1]),g(h,i)&&(j=!0,e[uf(b)]=d)}j||f.push(Od(a))}}),ba(a,function(a){var b=ia(a),c=vf(d,b);if(c)if(c.isArray){var g=e[c.propertyName];g||(g=[],e[c.propertyName]=g),g.push(yf(a))}else e[c.propertyName]=yf(a);else f.push(Pd(a))}),d.text&&(e.text=ha(a)),f.length&&(e.extensions=f),e},zf=function(a,c){var d=W(c),e=ea(d);return yf(e)||b};d.metadataHandler=Jc(zf,null,yd,wc);var Af="o",Bf="f",Cf="p",Df="c",Ef="s",Ff="l",Gf="odata",Hf=Gf+".",If="@"+Hf+"bind",Jf=Hf+"metadata",Kf=Hf+"navigationLinkUrl",Lf=Hf+"type",Mf={readLink:"self",editLink:"edit",nextLink:"__next",mediaReadLink:"media_src",mediaEditLink:"edit_media",mediaContentType:"content_type",mediaETag:"media_etag",count:"__count",media_src:"mediaReadLink",edit_media:"mediaEditLink",content_type:"mediaContentType",media_etag:"mediaETag",url:"uri"},Nf={metadata:"odata.metadata",count:"odata.count",next:"odata.nextLink",id:"odata.id",etag:"odata.etag",read:"odata.readLink",edit:"odata.editLink",mediaRead:"odata.mediaReadLink",mediaEdit:"odata.mediaEditLink",mediaEtag:"odata.mediaETag",mediaContentType:"odata.mediaContentType",actions:"odata.actions",functions:"odata.functions",navigationUrl:"odata.navigationLinkUrl",associationUrl:"odata.associationLinkUrl",type:"odata.type"},Of=function(a){if(a.indexOf(".")>0){var b=a.indexOf("@"),c=b>-1?a.substring(0,b):null,d=a.substring(b+1);return{target:c,name:d,isOData:0===d.indexOf(Hf)}}return null},Pf=function(a,b,c,d,e){return Cb(b)&&b[Lf]||c&&c[a+"@"+Lf]||d&&d.type||Vb(d,e)||null},Qf=function(a,b){return b?Nb(b.property,a)||Nb(b.navigationProperty,a):null},Rf=function(a){return Cb(a)&&Hf+"id"in a},Sf=function(a,b,c){if(b[a+"@"+Kf]||c&&c.relationship)return!0;var d=l(b[a])?b[a][0]:b[a];return Rf(d)},Tf=function(a){return Lb(a)||Hb(a)||Ib(a)},Uf=function(a,b,c,d,e){for(var f in a)if(f.indexOf(".")>0&&"#"!==f.charAt(0)){var g=Of(f);if(g){var h=g.name,i=g.target,j=null,k=null;i&&(j=Qf(i,d),k=Pf(i,a[i],a,j,e)),g.isOData?Vf(h,i,k,a[f],a,b,c):b[f]=a[f]}}return b},Vf=function(a,b,c,d,e,f,g){var h=a.substring(Hf.length);switch(h){case"navigationLinkUrl":return void Zf(h,b,c,d,e,f,g);case"nextLink":case"count":return void Xf(h,b,d,f,g);case"mediaReadLink":case"mediaEditLink":case"mediaContentType":case"mediaETag":return void Yf(h,b,c,d,f,g);default:return void Wf(h,b,d,f,g)}},Wf=function(a,b,c,d,e){var f=d.__metadata=d.__metadata||{},g=Mf[a]||a;if("editLink"===a)return f.uri=A(c,e),void(f[g]=f.uri);if(("readLink"===a||"associationLinkUrl"===a)&&(c=A(c,e)),b){var h=f.properties=f.properties||{},i=h[b]=h[b]||{};return"type"===a?void(i[g]=i[g]||c):void(i[g]=c)}f[g]=c},Xf=function(a,b,c,d,e){var f=Mf[a],g=b?d[b]:d;g[f]="nextLink"===a?A(c,e):c},Yf=function(a,b,c,d,e,f){var g=e.__metadata=e.__metadata||{},h=Mf[a];if(("mediaReadLink"===a||"mediaEditLink"===a)&&(d=A(d,f)),b){var i=g.properties=g.properties||{},j=i[b]=i[b]||{};return j.type=j.type||c,e.__metadata=g,e[b]=e[b]||{__mediaresource:{}},void(e[b].__mediaresource[h]=d)}g[h]=d},Zf=function(a,b,c,d,e,f,g){var h=f.__metadata=f.__metadata||{},i=h.properties=h.properties||{},j=i[b]=i[b]||{},k=A(d,g);return e.hasOwnProperty(b)?void(j.navigationLinkUrl=k):(f[b]={__deferred:{uri:k}},void(j.type=j.type||c))},$f=function(a,b,c,d,e,f,g){if("string"==typeof a)return _f(a,b,g);if(!Tf(b)){if(l(a))return ag(a,b,c,d,f,g);if(Cb(a))return bg(a,b,c,d,f,g)}return a},_f=function(a,b,c){switch(b){case Ra:return hc(a);case Ga:return ec(a,!1);case Ha:return fc(a,!1)}return c?ec(a,!0)||fc(a,!0)||a:a},ag=function(a,b,c,d,e,f){var g,h,i=wb(b),j=[],k=[];for(g=0,h=a.length;h>g;g++){var l=Pf(null,a[g])||i,m={type:l},n=$f(a[g],l,m,d,null,e,f);Tf(l)||Kb(a[g])||j.push(m),k.push(n)}return j.length>0&&(c.elements=j),{__metadata:{type:b},results:k}},bg=function(a,b,c,d,e,f){var g=dg(a,{type:b},d,e,f),h=g.__metadata,i=h.properties;return i&&(c.properties=i,delete h.properties),g},cg=function(a,b,c,d,e){return l(a)?fg(a,b,c,d,e):Cb(a)?dg(a,b,c,d,e):null},dg=function(a,c,d,e,f){c=c||{};var g=a[Lf]||c.type||null,h=Rb(g,e),i=!0;h||(i=!1,h=Qb(g,e));var j,k={type:g},l={__metadata:k},m={};if(i&&h&&c.entitySet&&"minimalmetadata"==c.contentTypeOdata){var n=d.substring(0,d.lastIndexOf("$metadata"));for(j=null,h.key||(j=h);j&&!j.key&&j.baseType;)j=Rb(j.baseType,e);if(h.key||j&&j.key){var o;if(o=h.key?gg(a,h):gg(a,j)){var p={key:o,entitySet:c.entitySet,functionImport:c.functionImport,containerName:c.containerName};hg(a,p,g,n,h,j)}}}for(var q in a)if(0===q.indexOf("#"))eg(q.substring(1),a[q],l,d,e);else if(-1===q.indexOf(".")){k.properties||(k.properties=m);var r=a[q],s=s=Qf(q,h);for(j=h;h&&null===s&&j.baseType;)j=Rb(j.baseType,e),s=s=Qf(q,j);var t=Sf(q,a,s),u=Pf(q,r,a,s,e),v=m[q]=m[q]||{type:u};if(t){var w={};if(c.entitySet!==b){var x=Wb(s,c.entitySet.name,e);w=Xb(x,e)}w.contentTypeOdata=c.contentTypeOdata,w.kind=c.kind,w.type=u,l[q]=cg(r,w,d,e,f)}else l[q]=$f(r,u,v,d,s,e,f)}return Uf(a,l,d,h,e)},eg=function(a,b,c,d,e){if(a&&(l(b)||Cb(b))){var f=!1,g=a.lastIndexOf("."),h=a.substring(g+1),i=g>-1?a.substring(0,g):"",j=h===a||-1===i.indexOf(".")?Sb(e):Tb(i,e);if(j){var k=Ub(j.functionImport,h);k&&k.isSideEffecting&&(f=!bc(k.isSideEffecting))}var m,n,o=c.__metadata,p=f?"functions":"actions",q=A(a,d),r=l(b)?b:[b];for(m=0,n=r.length;n>m;m++){var s=r[m];if(s){var t=o[p]=o[p]||[],u={metadata:q,title:s.title,target:A(s.target,d)};t.push(u)}}}},fg=function(a,b,c,d,e){var f,g,h,i=l(a)?a:a.value,j=[];for(f=0,g=i.length;g>f;f++)h=dg(i[f],b,c,d,e),j.push(h);var k={results:j};if(Cb(a)){for(var m in a)0===m.indexOf("#")&&(k.__metadata=k.__metadata||{},eg(m.substring(1),a[m],k,c,d));k=Uf(a,k,c)}return k},gg=function(a,b){var c,d,e=b.key.propertyRef;if(c="(",1==e.length)d=Nb(b.property,e[0].name).type,c+=lg(a[e[0].name],d);else for(var f=!0,g=0;g<e.length;g++)f?f=!1:c+=",",d=Nb(b.property,e[g].name).type,c+=e[g].name+"="+lg(a[e[g].name],d);return c+=")"},hg=function(a,b,c,d,e,f){var g=a[Nf.id]||a[Nf.read]||a[Nf.edit]||b.entitySet.name+b.key;if(a[Nf.id]=d+g,a[Nf.edit]||(a[Nf.edit]=b.entitySet.name+b.key,b.entitySet.entityType!=c&&(a[Nf.edit]+="/"+c)),a[Nf.read]=a[Nf.read]||a[Nf.edit],!a[Nf.etag]){var h=ig(a,e,f);h&&(a[Nf.etag]=h)}og(a,e,f),kg(a,e,f),ng(a,b)},ig=function(a,b,c){for(var d,e="",f=0;b.property&&f<b.property.length;f++)d=b.property[f],e=jg(a,e,d);if(c)for(f=0;c.property&&f<c.property.length;f++)d=c.property[f],e=jg(a,e,d);return e.length>0?e+'"':null},jg=function(a,b,c){return"Fixed"==c.concurrencyMode&&(b+=b.length>0?",":'W/"',b+=null!==a[c.name]?lg(a[c.name],c.type):"null"),b},kg=function(a,c,d){for(var e,f,g,h="@odata.navigationLinkUrl",i="@odata.associationLinkUrl",j=0;c.navigationProperty&&j<c.navigationProperty.length;j++)e=c.navigationProperty[j].name,f=e+h,a[f]===b&&(a[f]=a[Nf.edit]+"/"+encodeURIComponent(e)),g=e+i,a[g]===b&&(a[g]=a[Nf.edit]+"/$links/"+encodeURIComponent(e));if(d&&d.navigationProperty)for(j=0;j<d.navigationProperty.length;j++)e=d.navigationProperty[j].name,f=e+h,a[f]===b&&(a[f]=a[Nf.edit]+"/"+encodeURIComponent(e)),g=e+i,a[g]===b&&(a[g]=a[Nf.edit]+"/$links/"+encodeURIComponent(e))},lg=function(a,b){switch(a=""+mg(a,b),a=encodeURIComponent(a.replace("'","''")),b){case"Edm.Binary":return"X'"+a+"'";case"Edm.DateTime":return"datetime'"+a+"'";case"Edm.DateTimeOffset":return"datetimeoffset'"+a+"'";case"Edm.Decimal":return a+"M";case"Edm.Guid":return"guid'"+a+"'";case"Edm.Int64":return a+"L";case"Edm.Float":return a+"f";case"Edm.Double":return a+"D";case"Edm.Geography":return"geography'"+a+"'";case"Edm.Geometry":return"geometry'"+a+"'";case"Edm.Time":return"time'"+a+"'";case"Edm.String":return"'"+a+"'";default:return a}},mg=function(a,b){switch(b){case"Edm.Binary":return D(a);default:return a}},ng=function(a,c){for(var d=c.functionImport||[],e=0;e<d.length;e++)if(d[e].isBindable&&d[e].parameter[0]&&d[e].parameter[0].type==c.entitySet.entityType){var f="#"+c.containerName+"."+d[e].name;a[f]==b&&(a[f]={title:d[e].name,target:a[Nf.edit]+"/"+d[e].name})}},og=function(a,b,c){(b.hasStream||c&&c.hasStream)&&(a[Nf.mediaEdit]=a[Nf.mediaEdit]||a[Nf.mediaEdit]+"/$value",a[Nf.mediaRead]=a[Nf.mediaRead]||a[Nf.mediaEdit])},pg=function(a,b,c,d){var e={type:b},f=$f(a.value,b,e,c,null,null,d);return Uf(a,{__metadata:e,value:f},c)},qg=function(a,b,c,d,e){var f={},g=ag(a.value,b,f,c,d,e);return j(g.__metadata,f),Uf(a,g,c)},rg=function(a,b){var c=a.value;if(!l(c))return sg(a,b);var d,e,f=[];for(d=0,e=c.length;e>d;d++)f.push(sg(c[d],b));var g={results:f};return Uf(a,g,b)},sg=function(a,b){var c={uri:A(a.url,b)};c=Uf(a,c,b);var d=c.__metadata||{},e=d.properties||{};return tg(e.url),p(e,"url","uri"),c},tg=function(a){a&&delete a.type},ug=function(a,b){var c=a.value,d=[],e=Uf(a,{collections:d},b),f=e.__metadata||{},g=f.properties||{};tg(g.value),p(g,"value","collections");var h,i;for(h=0,i=c.length;i>h;h++){var j=c[h],k={title:j.name,href:A(j.url,b)};k=Uf(j,k,b),f=k.__metadata||{},g=f.properties||{},tg(g.name),tg(g.url),p(g,"name","title"),p(g,"url","href"),d.push(k)}return{workspaces:[e]}},vg=function(a,b){return{kind:a,type:b||null}},wg=function(a,b,c){var d=a[Jf];if(!d||"string"!=typeof d)return null;var e=d.lastIndexOf("#");if(-1===e)return vg(Ef);var f=d.indexOf("@Element",e),g=f-1;0>g&&(g=d.indexOf("?",e),-1===g&&(g=d.length));var h=d.substring(e+1,g);if(h.indexOf("/$links/")>0)return vg(Ff);var i=h.split("/");if(i.length>=0){var j=i[0],k=i[1];if(Tf(j))return vg(Cf,j);if(Bb(j))return vg(Df,j);var m,n,o,p=k;if(!k){var q=j.lastIndexOf("."),r=j.substring(q+1),s=r===j?Sb(b):Tb(j.substring(0,q),b);s&&(m=Pb(s.entitySet,r),n=s.functionImport,o=s.name,p=m?m.entityType:null)}var t;if(f>0)return t=vg(Af,p),t.entitySet=m,t.functionImport=n,t.containerName=o,t;if(p)return t=vg(Bf,p),t.entitySet=m,t.functionImport=n,t.containerName=o,t;if(l(a.value)&&!Qb(j,b)){var u=a.value[0];if(!Kb(u)&&(Rf(u)||!c))return vg(Bf,null)}return vg(Af,j)}return null},xg=function(a,b,c,d,e){if(!Cb(a))return a;e=e||"minimalmetadata";var g=a[Jf],h=wg(a,b,d);f(h)&&(h.contentTypeOdata=e);var i=null;if(h)switch(delete a[Jf],i=h.type,h.kind){case Bf:return fg(a,h,g,b,c);case Df:return qg(a,i,g,b,c);case Cf:return pg(a,i,g,c);case Ef:return ug(a,g);case Ff:return rg(a,g)}return dg(a,h,g,b,c)},yg=["type","etag","media_src","edit_media","content_type","media_etag"],zg=function(a,b){var c=/\/\$links\//,d={},e=a.__metadata,f=b&&c.test(b.request.requestUri);return Bg(a,e&&e.properties,d,f),d},Ag=function(a,b){if(a){var c,d;for(c=0,d=yg.length;d>c;c++){var e=yg[c],f=Hf+(Mf[e]||e);Jg(f,null,a[e],b)}}},Bg=function(a,b,c,d){for(var e in a){var f=a[e];"__metadata"===e?Ag(f,c):-1===e.indexOf(".")?d&&"uri"===e?Dg(f,c):Cg(e,f,b,c,d):c[e]=f}},Cg=function(a,c,d,e){var f=d&&d[a]||{properties:b,type:b},g=Ba(c,f);return Kb(c)||!c?(Jg(Lf,a,g,e),void(e[a]=c)):Gb(c,g)||Fb(c)?void Gg(a,c,e):!g&&Eb(c)?void Eg(a,c,e):Ab(c,g)?(wb(g)&&Jg(Lf,a,g,e),void Fg(a,c,e)):(e[a]={},Jg(Lf,null,g,e[a]),void Bg(c,f.properties,e[a]))},Dg=function(a,b){b.url=a},Eg=function(a,b,c){Jg(Kf,a,b.__deferred.uri,c)},Fg=function(a,b,c){c[a]=[];var d=l(b)?b:b.results;Bg(d,null,c[a])},Gg=function(a,b,c){if(Gb(b)){c[a]=[];var d,e,f=l(b)?b:b.results;for(d=0,e=f.length;e>d;d++)Hg(a,f[d],!0,c)}else Hg(a,b,!1,c)},Hg=function(a,b,c,d){var e=b.__metadata&&b.__metadata.uri;if(e)return void Ig(a,e,c,d);var f=zg(b);return c?void d[a].push(f):void(d[a]=f)},Ig=function(a,b,c,d){var e=a+If;return c?(d[e]=d[e]||[],void d[e].push(b)):void(d[e]=b)},Jg=function(a,c,d,e){d!==b&&(c?e[c+"@"+a]=d:e[a]=d)},Kg="application/json",Lg=xc(Kg),Mg=function(a){var b=[];for(var c in a){var d,e;for(d=0,e=a[c].length;e>d;d++)b.push(j({metadata:c},a[c][d]))}return b},Ng=function(a,b,c,d){if(a&&"object"==typeof a){var e,f=a.__metadata;f&&(f.actions&&(f.actions=Mg(f.actions)),f.functions&&(f.functions=Mg(f.functions)),e=f&&f.type);var g,h=Rb(e,b)||Qb(e,b);if(h){var i=h.property;if(i){var j,k;for(j=0,k=i.length;k>j;j++){var l=i[j],m=l.name;if(g=a[m],"Edm.DateTime"===l.type||"Edm.DateTimeOffset"===l.type){if(g){if(g=c(g),!g)throw{message:"Invalid date/time value"};a[m]=g}}else"Edm.Time"===l.type&&(a[m]=hc(g))}}}else if(d)for(var n in a)g=a[n],"string"==typeof g&&(a[n]=c(g)||g)}return a},Og=function(a){if(a){var b=a.properties.odata;return"nometadata"===b||"minimalmetadata"===b||"fullmetadata"===b}return!1},Pg=function(a,b){var c,d,e={collections:[]};for(c=0,d=a.EntitySets.length;d>c;c++){var f=a.EntitySets[c],g={title:f,href:A(f,b)};e.collections.push(g)}return{workspaces:[e]}},Qg=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,Rg=function(a){var b;0>a?(b="-",a=-a):b="+";var c=Math.floor(a/60);return a-=60*c,b+ub(c,2)+":"+ub(a,2)},Sg=function(a){var b=a&&Qg.exec(a);if(b){var c=new Date(o(b[1]));if(b[2]){var d=o(b[3]);"-"===b[2]&&(d=-d);var e=c.getUTCMinutes();c.setUTCMinutes(e-d),c.__edmType="Edm.DateTimeOffset",c.__offset=Rg(d)}if(!isNaN(c.valueOf()))return c}},Tg=function(b,c,d){var e=h(d.recognizeDates,b.recognizeDates),f=h(d.inferJsonLightFeedAsObject,b.inferJsonLightFeedAsObject),g=d.metadata,i=d.dataServiceVersion,j=Sg,k="string"==typeof c?a.JSON.parse(c):c;if($b("3.0",i)===i){if(Og(d.contentType))return xg(k,g,e,f,d.contentType.properties.odata);j=ec}return k=lc(k.d,function(a,b){return Ng(b,g,j,e)}),k=Yg(k,d.dataServiceVersion),Xg(k,d.response.requestUri)},Ug=function(b){var c,d=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return sb(this)},c=a.JSON.stringify(b,Wg)}finally{Date.prototype.toJSON=d}return c},Vg=function(a,c,d){var e=d.dataServiceVersion||"1.0",f=h(d.useJsonLight,a.useJsonLight),g=d.contentType=d.contentType||Lg;if(g&&g.mediaType===Lg.mediaType){var i=c;return f||Og(g)?(d.dataServiceVersion=$b(e,"3.0"),i=zg(c,d),Ug(i)):($b("3.0",e)===e&&(g.properties.odata="verbose",d.contentType=g),Ug(i))}return b},Wg=function(a,b){return b&&"Edm.Time"===b.__edmType?tb(b):b},Xg=function(a,b){var c=Cb(a)&&!a.__metadata&&l(a.EntitySets);return c?Pg(a,b):a},Yg=function(a,b){return b&&b.lastIndexOf(";")===b.length-1&&(b=b.substr(0,b.length-1)),b&&"1.0"!==b||l(a)&&(a={results:a}),a},Zg=Jc(Tg,Vg,Kg,wc);Zg.recognizeDates=!1,Zg.useJsonLight=!1,Zg.inferJsonLightFeedAsObject=!1,d.jsonHandler=Zg;var $g="multipart/mixed",_g=/^HTTP\/1\.\d (\d{3}) (.*)$/i,ah=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,bh=function(){return Math.floor(65536*(1+Math.random())).toString(16).substr(1)},ch=function(a){return a+bh()+"-"+bh()+"-"+bh()},dh=function(a){return a.handler.partHandler},eh=function(a){var b=a.boundaries;return b[b.length-1]},fh=function(a,b,c){var d=c.contentType.properties.boundary;return{__batchResponses:hh(b,{boundaries:[d],handlerContext:c})}},gh=function(a,b,c){var d=c.contentType=c.contentType||xc($g);return d.mediaType===$g?mh(b,c):void 0},hh=function(a,b){var c="--"+eh(b);lh(a,b,c),kh(a,b);for(var d,e=[];"--"!==d&&b.position<a.length;){var f,g=ih(a,b),h=xc(g["Content-Type"]);if(h&&h.mediaType===$g){b.boundaries.push(h.properties.boundary);try{f=hh(a,b)}catch(i){i.response=jh(a,b,c),f=[i]}e.push({__changeResponses:f}),b.boundaries.pop(),lh(a,b,"--"+eh(b))}else{if(!h||"application/http"!==h.mediaType)throw{message:"invalid MIME part type "};kh(a,b);var j=jh(a,b,c);try{j.statusCode>=200&&j.statusCode<=299?dh(b.handlerContext).read(j,b.handlerContext):j={message:"HTTP request failed",response:j}}catch(i){j=i}e.push(j)}d=a.substr(b.position,2),kh(a,b)}return e},ih=function(a,b){var c,d,e,f={};do e=b.position,d=kh(a,b),c=ah.exec(d),null!==c?f[c[1]]=c[2]:b.position=e;while(d&&c);return ac(f),f},jh=function(a,b,c){var d,e,f,g=b.position,h=_g.exec(kh(a,b));return h?(d=h[1],e=h[2],f=ih(a,b),kh(a,b)):b.position=g,{statusCode:d,statusText:e,headers:f,body:lh(a,b,c)}},kh=function(a,b){return lh(a,b,"\r\n")},lh=function(a,b,c){var d=b.position||0,e=a.length;if(c){if(e=a.indexOf(c,d),-1===e)return null;b.position=e+c.length}else b.position=e;return a.substring(d,e)},mh=function(a,b){if(!yb(a))throw{message:"Data is not a batch object."};var c,d,e=ch("batch_"),f=a.__batchRequests,g="";for(c=0,d=f.length;d>c;c++)g+=nh(e,!1)+oh(f[c],b);g+=nh(e,!0);var h=b.contentType.properties;return h.boundary=e,g},nh=function(a,b){var c="\r\n--"+a;return b&&(c+="--"),c+"\r\n"},oh=function(a,b,c){var d,e=a.__changeRequests;if(l(e)){if(c)throw{message:"Not Supported: change set nested in other change set"};var f=ch("changeset_");d="Content-Type: "+$g+"; boundary="+f+"\r\n";var g,h;for(g=0,h=e.length;h>g;g++)d+=nh(f,!1)+oh(e[g],b,!0);d+=nh(f,!0)}else{d="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";var i=j({},b);i.handler=Jc,i.request=a,i.contentType=null,jc(a,dh(b),i),d+=ph(a)}return d},ph=function(a){var b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(var c in a.headers)a.headers[c]&&(b=b+c+": "+a.headers[c]+"\r\n");return b+="\r\n",a.body&&(b+=a.body),b};d.batchHandler=Jc(fh,gh,$g,wc);var qh=[d.jsonHandler,d.atomHandler,d.xmlHandler,d.textHandler],rh=function(a,b,c){var d,e;for(d=0,e=qh.length;e>d&&!qh[d][a](b,c);d++);if(d===e)throw{message:"no handler for data"}};d.defaultSuccess=function(b){a.alert(a.JSON.stringify(b))},d.defaultError=q,d.defaultHandler={read:function(a,b){a&&f(a.body)&&a.headers["Content-Type"]&&rh("read",a,b)},write:function(a,b){rh("write",a,b)},maxDataServiceVersion:wc,accept:"application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1"},d.defaultMetadata=[],d.read=function(a,b,c,e,f,g){var h;return h=a instanceof String||"string"==typeof a?{requestUri:a}:a,d.request(h,b,c,e,f,g)},d.request=function(a,b,c,e,f,g){b=b||d.defaultSuccess,c=c||d.defaultError,e=e||d.defaultHandler,f=f||d.defaultHttpClient,g=g||d.defaultMetadata,a.recognizeDates=h(a.recognizeDates,d.jsonHandler.recognizeDates),a.callbackParameterName=h(a.callbackParameterName,d.defaultHttpClient.callbackParameterName),a.formatQueryString=h(a.formatQueryString,d.defaultHttpClient.formatQueryString),a.enableJsonpCallback=h(a.enableJsonpCallback,d.defaultHttpClient.enableJsonpCallback),a.useJsonLight=h(a.useJsonLight,d.jsonHandler.enableJsonpCallback),a.inferJsonLightFeedAsObject=h(a.inferJsonLightFeedAsObject,d.jsonHandler.inferJsonLightFeedAsObject);var i={metadata:g,recognizeDates:a.recognizeDates,callbackParameterName:a.callbackParameterName,
formatQueryString:a.formatQueryString,enableJsonpCallback:a.enableJsonpCallback,useJsonLight:a.useJsonLight,inferJsonLightFeedAsObject:a.inferJsonLightFeedAsObject};try{return jc(a,e,i),xb(a,b,c,e,f,i)}catch(j){c(j)}},d.parseMetadata=function(a){return zf(null,a)},d.batchHandler.partHandler=d.defaultHandler;var sh=null,th=function(){var a={v:this.valueOf(),t:"[object Date]"};for(var b in this)a[b]=this[b];return a},uh=function(a,b){if(b&&"[object Date]"===b.t){var c=new Date(b.v);for(var d in b)"t"!==d&&"v"!==d&&(c[d]=b[d]);b=c}return b},vh=function(a,b){return a.name+"#!#"+b},wh=function(a,b){return b.replace(a.name+"#!#","")},xh=function(a){this.name=a};xh.create=function(b){if(xh.isSupported())return sh=sh||a.localStorage,new xh(b);throw{message:"Web Storage not supported by the browser"}},xh.isSupported=function(){return!!a.localStorage},xh.prototype.add=function(a,b,c,d){d=d||this.defaultError;var e=this;this.contains(a,function(f){f?i(d,{message:"key already exists",key:a}):e.addOrUpdate(a,b,c,d)},d)},xh.prototype.addOrUpdate=function(c,d,e,f){if(f=f||this.defaultError,c instanceof Array)f({message:"Array of keys not supported"});else{var g=vh(this,c),h=Date.prototype.toJSON;try{var j=d;j!==b&&(Date.prototype.toJSON=th,j=a.JSON.stringify(d)),sh.setItem(g,j),i(e,c,d)}catch(k){22===k.code||2147942414===k.number?i(f,{name:"QUOTA_EXCEEDED_ERR",error:k}):i(f,k)}finally{Date.prototype.toJSON=h}}},xh.prototype.clear=function(a,b){b=b||this.defaultError;try{for(var c=0,d=sh.length;d>0&&d>c;){var e=sh.key(c),f=wh(this,e);e!==f?(sh.removeItem(e),d=sh.length):c++}i(a)}catch(g){i(b,g)}},xh.prototype.close=function(){},xh.prototype.contains=function(a,b,c){c=c||this.defaultError;try{var d=vh(this,a),e=sh.getItem(d);i(b,null!==e)}catch(f){i(c,f)}},xh.prototype.defaultError=q,xh.prototype.getAllKeys=function(a,b){b=b||this.defaultError;var c,d,e=[];try{for(c=0,d=sh.length;d>c;c++){var f=sh.key(c),g=wh(this,f);f!==g&&e.push(g)}i(a,e)}catch(h){i(b,h)}},xh.prototype.mechanism="dom",xh.prototype.read=function(c,d,e){if(e=e||this.defaultError,c instanceof Array)e({message:"Array of keys not supported"});else try{var f=vh(this,c),g=sh.getItem(f);g=null!==g&&"undefined"!==g?a.JSON.parse(g,uh):b,i(d,c,g)}catch(h){i(e,h)}},xh.prototype.remove=function(a,b,c){if(c=c||this.defaultError,a instanceof Array)c({message:"Batches not supported"});else try{var d=vh(this,a);sh.removeItem(d),i(b)}catch(e){i(c,e)}},xh.prototype.update=function(a,b,c,d){d=d||this.defaultError;var e=this;this.contains(a,function(f){f?e.addOrUpdate(a,b,c,d):i(d,{message:"key not found",key:a})},d)};var yh=a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB||a.indexedDB,zh=a.IDBKeyRange||a.webkitIDBKeyRange,Ah=a.IDBTransaction||a.webkitIDBTransaction||{},Bh=Ah.READ_ONLY||"readonly",Ch=Ah.READ_WRITE||"readwrite",Dh=function(a,b){return function(c){var d=a||b;if(d){if("[object IDBDatabaseException]"===Object.prototype.toString.call(c))return 11===c.code?void d({name:"QuotaExceededError",error:c}):void d(c);var e;try{var f=c.target.error||c;e=f.name}catch(g){e="blocked"===c.type?"IndexedDBBlocked":"UnknownError"}d({name:e,error:c})}}},Eh=function(a,b,c){var d=a.name,e="_datajs_"+d,f=yh.open(e);f.onblocked=c,f.onerror=c,f.onupgradeneeded=function(){var a=f.result;a.objectStoreNames.contains(d)||a.createObjectStore(d)},f.onsuccess=function(a){var e=f.result;if(!e.objectStoreNames.contains(d)){if("setVersion"in e){var g=e.setVersion("1.0");return g.onsuccess=function(){var a=g.transaction;a.oncomplete=function(){b(e)},e.createObjectStore(d,null,!1)},g.onerror=c,void(g.onblocked=c)}return a.target.error={name:"DBSchemaMismatch"},void c(a)}e.onversionchange=function(a){a.target.close()},b(e)}},Fh=function(a,b,c,d){var e=a.name,f=a.db,g=Dh(d,a.defaultError);return f?void c(f.transaction(e,b)):void Eh(a,function(d){a.db=d,c(d.transaction(e,b))},g)},Gh=function(a){this.name=a};Gh.create=function(a){if(Gh.isSupported())return new Gh(a);throw{message:"IndexedDB is not supported on this browser"}},Gh.isSupported=function(){return!!yh},Gh.prototype.add=function(a,b,c,d){var e=this.name,f=this.defaultError,g=[],h=[];a instanceof Array?(g=a,h=b):(g=[a],h=[b]),Fh(this,Ch,function(i){i.onabort=Dh(d,f,a,"add"),i.oncomplete=function(){a instanceof Array?c(g,h):c(a,b)};for(var j=0;j<g.length&&j<h.length;j++)i.objectStore(e).add({v:h[j]},g[j])},d)},Gh.prototype.addOrUpdate=function(a,b,c,d){var e=this.name,f=this.defaultError,g=[],h=[];a instanceof Array?(g=a,h=b):(g=[a],h=[b]),Fh(this,Ch,function(i){i.onabort=Dh(d,f),i.oncomplete=function(){a instanceof Array?c(g,h):c(a,b)};for(var j=0;j<g.length&&j<h.length;j++){var k={v:h[j]};i.objectStore(e).put(k,g[j])}},d)},Gh.prototype.clear=function(a,b){var c=this.name,d=this.defaultError;Fh(this,Ch,function(e){e.onerror=Dh(b,d),e.oncomplete=function(){a()},e.objectStore(c).clear()},b)},Gh.prototype.close=function(){this.db&&(this.db.close(),this.db=null)},Gh.prototype.contains=function(a,b,c){var d=this.name,e=this.defaultError;Fh(this,Bh,function(f){var g=f.objectStore(d),h=g.get(a);f.oncomplete=function(){b(!!h.result)},f.onerror=Dh(c,e)},c)},Gh.prototype.defaultError=q,Gh.prototype.getAllKeys=function(a,b){var c=this.name,d=this.defaultError;Fh(this,Ch,function(e){var f=[];e.oncomplete=function(){a(f)};var g=e.objectStore(c).openCursor();g.onerror=Dh(b,d),g.onsuccess=function(a){var b=a.target.result;b&&(f.push(b.key),b["continue"].call(b))}},b)},Gh.prototype.mechanism="indexeddb",Gh.prototype.read=function(a,c,d){var e=this.name,f=this.defaultError,g=a instanceof Array?a:[a];Fh(this,Bh,function(h){var i=[];h.onerror=Dh(d,f,a,"read"),h.oncomplete=function(){a instanceof Array?c(g,i):c(g[0],i[0])};for(var j=0;j<g.length;j++){var k=h.objectStore(e),l=k.get.call(k,g[j]);l.onsuccess=function(a){var c=a.target.result;i.push(c?c.v:b)}}},d)},Gh.prototype.remove=function(a,b,c){var d=this.name,e=this.defaultError,f=a instanceof Array?a:[a];Fh(this,Ch,function(a){a.onerror=Dh(c,e),a.oncomplete=function(){b()};for(var g=0;g<f.length;g++){var h=a.objectStore(d);h["delete"].call(h,f[g])}},c)},Gh.prototype.update=function(a,b,c,d){var e=this.name,f=this.defaultError,g=[],h=[];a instanceof Array?(g=a,h=b):(g=[a],h=[b]),Fh(this,Ch,function(i){i.onabort=Dh(d,f),i.oncomplete=function(){a instanceof Array?c(g,h):c(a,b)};for(var j=0;j<g.length&&j<h.length;j++){var k=i.objectStore(e).openCursor(zh.only(g[j])),l={v:h[j]};k.pair={key:g[j],value:l},k.onsuccess=function(a){var b=a.target.result;b?b.update(a.target.pair.value):i.abort()}}},d)};var Hh=function(a){var c=[],d=[],e={};this.name=a;var f=function(a){return a||this.defaultError},g=function(a,c){var d;return a instanceof Array&&(d="Array of keys not supported"),(a===b||null===a)&&(d="Invalid key"),d?(i(c,{message:d}),!1):!0};this.add=function(a,b,c,d){d=f(d),g(a,d)&&(e.hasOwnProperty(a)?d({message:"key already exists",key:a}):this.addOrUpdate(a,b,c,d))},this.addOrUpdate=function(a,h,j,k){if(k=f(k),g(a,k)){var l=e[a];l===b&&(l=c.length>0?c.splice(0,1):d.length),d[l]=h,e[a]=l,i(j,a,h)}},this.clear=function(a){d=[],e={},c=[],i(a)},this.contains=function(a,b){var c=e.hasOwnProperty(a);i(b,c)},this.getAllKeys=function(a){var b=[];for(var c in e)b.push(c);i(a,b)},this.read=function(a,b,c){if(c=f(c),g(a,c)){var h=e[a];i(b,a,d[h])}},this.remove=function(a,h,j){if(j=f(j),g(a,j)){var k=e[a];k!==b&&(k===d.length-1?d.pop():(d[k]=b,c.push(k)),delete e[a],0===d.length&&(c=[])),i(h)}},this.update=function(a,b,c,d){d=f(d),g(a,d)&&(e.hasOwnProperty(a)?this.addOrUpdate(a,b,c,d):d({message:"key not found",key:a}))}};Hh.create=function(a){return new Hh(a)},Hh.isSupported=function(){return!0},Hh.prototype.close=function(){},Hh.prototype.defaultError=q,Hh.prototype.mechanism="memory";var Ih={indexeddb:Gh,dom:xh,memory:Hh};c.defaultStoreMechanism="best",c.createStore=function(a,b){b||(b=c.defaultStoreMechanism),"best"===b&&(b=xh.isSupported()?"dom":"memory");var d=Ih[b];if(d)return d.create(a);throw{message:"Failed to create store",name:a,mechanism:b}};var Jh=function(a,b){var c=a.indexOf("?")>=0?"&":"?";return a+c+b},Kh=function(a,b){var c=a.indexOf("?"),d="";return c>=0&&(d=a.substr(c),a=a.substr(0,c)),"/"!==a[a.length-1]&&(a+="/"),a+b+d},Lh=function(a,b){return{method:"GET",requestUri:a,user:b.user,password:b.password,enableJsonpCallback:b.enableJsonpCallback,callbackParameterName:b.callbackParameterName,formatQueryString:b.formatQueryString}},Mh=function(a,b,c,d){var e=Nh(a,b,[],c,d);return e},Nh=function(a,c,e,f,g){var h=Lh(a,c),i=d.request(h,function(a){var b=a.__next,d=a.results;e=e.concat(d),b?i=Nh(b,c,e,f,g):f(e)},g,b,c.httpClient,c.metadata);return{abort:function(){i.abort()}}},Oh=function(a){var c=this,e=a.source;return c.identifier=z(encodeURI(decodeURI(e))),c.options=a,c.count=function(a,f){var g=c.options;return d.request(Lh(Kh(e,"$count"),g),function(b){var c=o(b.toString());isNaN(c)?f({message:"Count is NaN",count:c}):a(c)},f,b,g.httpClient,g.metadata)},c.read=function(a,b,d,f){var g="$skip="+a+"&$top="+b;return Mh(Jh(e,g),c.options,d,f)},c},Ph=function(a,b){var c=Qh(a,b);if(c){var d=c.i-b.i,e=d+(a.c-a.d.length);a.d=a.d.concat(b.d.slice(d,e))}},Qh=function(a,b){var c,d=a.i+a.c,e=b.i+b.c,f=a.i>b.i?a.i:b.i,g=e>d?d:e;return g>=f&&(c={i:f,c:g-f}),c},Rh=function(a,c){if(a===b||"number"!=typeof a)throw{message:"'"+c+"' must be a number."};if(isNaN(a)||0>a||!isFinite(a))throw{message:"'"+c+"' must be greater than or equal to zero."}},Sh=function(a,c){if(a!==b){if("number"!=typeof a)throw{message:"'"+c+"' must be a number."};if(isNaN(a)||0>=a||!isFinite(a))throw{message:"'"+c+"' must be greater than zero."}}},Th=function(a,c){if(a!==b&&("number"!=typeof a||isNaN(a)||!isFinite(a)))throw{message:"'"+c+"' must be a number."}},Uh=function(a,b){var c,d;for(c=0,d=a.length;d>c;c++)if(a[c]===b)return a.splice(c,1),!0;return!1},Vh=function(a){var b=0,c=typeof a;if("object"===c&&a)for(var d in a)b+=2*d.length+Vh(a[d]);else b="string"===c?2*a.length:8;return b},Wh=function(a,b,c){return a=Math.floor(a/c)*c,b=Math.ceil((b+1)/c)*c,{i:a,c:b-a}},Xh="destroy",Yh="idle",Zh="init",$h="read",_h="prefetch",ai="write",bi="cancel",ci="end",di="error",ei="start",fi="wait",gi="clear",hi="done",ii="local",ji="save",ki="source",li=function(a,b,c,d,e,f,g){var h,i,j=this;j.p=b,j.i=d,j.c=e,j.d=f,j.s=ei,j.canceled=!1,j.pending=g,j.oncomplete=null,j.cancel=function(){if(c){var a=j.s;a!==di&&a!==ci&&a!==bi&&(j.canceled=!0,l(bi,h))}},j.complete=function(){l(ci,h)},j.error=function(a){j.canceled||l(di,a)},j.run=function(a){i=a,j.transition(j.s,h)},j.wait=function(a){l(fi,a)};var k=function(b,c,d){switch(b){case ei:c!==Zh&&a(j,b,c,d);break;case fi:a(j,b,c,d);break;case bi:a(j,b,c,d),j.fireCanceled(),l(ci);break;case di:a(j,b,c,d),j.canceled=!0,j.fireRejected(d),l(ci);break;case ci:j.oncomplete&&j.oncomplete(j),j.canceled||j.fireResolved(),a(j,b,c,d);break;default:a(j,b,c,d)}},l=function(a,b){j.s=a,h=b,k(a,i,b)};return j.transition=l,j};li.prototype.fireResolved=function(){var a=this.p;a&&(this.p=null,a.resolve(this.d))},li.prototype.fireRejected=function(a){var b=this.p;b&&(this.p=null,b.reject(a))},li.prototype.fireCanceled=function(){this.fireRejected({canceled:!0,message:"Operation canceled"})};var mi=function(d){var e,g=Zh,h={counts:0,netReads:0,prefetches:0,cacheReads:0},k=[],l=[],m=[],n=0,p=!1,q=s(d.cacheSize,1048576),r=0,t=0,u=0,v=0===q,w=s(d.pageSize,50),x=s(d.prefetchSize,w),y="1.0",z=0,A=d.source;"string"==typeof A&&(A=new Oh(d)),A.options=d;var B=c.createStore(d.name,d.mechanism),C=this;C.onidle=d.idle,C.stats=h,C.count=function(){if(e)throw e;var a=Aa(),b=!1;if(p)return i(function(){a.resolve(r)}),a.promise();var c=A.count(function(b){c=null,h.counts++,a.resolve(b)},function(d){c=null,a.reject(j(d,{canceled:b}))});return j(a.promise(),{cancel:function(){c&&(b=!0,c.abort(),c=null)}})},C.clear=function(){if(e)throw e;if(0===k.length){var a=Aa(),b=new li(S,a,!1);return L(b,k),a.promise()}return k[0].p},C.filterForward=function(a,b,c){return I(a,b,c,!1)},C.filterBack=function(a,b,c){return I(a,b,c,!0)},C.readRange=function(a,b){if(Rh(a,"index"),Rh(b,"count"),e)throw e;var c=Aa(),d=new li(U,c,!0,a,b,[],0);return L(d,l),j(c.promise(),{cancel:function(){d.cancel()}})},C.ToObservable=C.toObservable=function(){if(!a.Rx||!a.Rx.Observable)throw{message:"Rx library not available - include rx.js"};if(e)throw e;return a.Rx.Observable.CreateWithDisposable(function(a){var b=!1,c=0,d=function(c){b||a.OnError(c)},e=function(f){if(!b){var g,h;for(g=0,h=f.length;h>g;g++)a.OnNext(f[g]);f.length<w?a.OnCompleted():(c+=w,C.readRange(c,w).then(e,d))}};return C.readRange(c,w).then(e,d),{Dispose:function(){b=!0}}})};var D=function(a){return function(b){e={message:a,error:b};var c,d;for(c=0,d=l.length;d>c;c++)l[c].fireRejected(e);for(c=0,d=k.length;d>c;c++)k[c].fireRejected(e);l=k=null}},E=function(a){if(a!==g){g=a;var b,c,d=k.concat(l,m);for(b=0,c=d.length;c>b;b++)d[b].run(g)}},F=function(){var a=new za;return B.clear(function(){n=0,p=!1,r=0,t=0,u=0,v=0===q,h={counts:0,netReads:0,prefetches:0,cacheReads:0},C.stats=h,B.close(),a.resolve()},function(b){a.reject(b)}),a},G=function(a){var b=Uh(k,a);b||(b=Uh(l,a),b||Uh(m,a)),z--,E(Yh)},H=function(a){var b=new za,c=!1,d=A.read(a,w,function(c){var d={i:a,c:c.length,d:c};b.resolve(d)},function(a){b.reject(a)});return j(b,{cancel:function(){d&&(d.abort(),c=!0,d=null)}})},I=function(a,b,c,d){if(a=o(a),b=o(b),isNaN(a))throw{message:"'index' must be a valid number.",index:a};if(isNaN(b))throw{message:"'count' must be a valid number.",count:b};if(e)throw e;a=Math.max(a,0);var f=Aa(),g=[],h=!1,i=null,k=function(a,e){h||(b>=0&&g.length>=b?f.resolve(g):i=C.readRange(a,e).then(function(h){for(var i=0,j=h.length;j>i&&(0>b||g.length<b);i++){var l=d?j-i-1:i,m=h[l];if(c(m)){var n={index:a+l,item:m};d?g.unshift(n):g.push(n)}}if(!d&&h.length<e||d&&0>=a)f.resolve(g);else{var o=d?Math.max(a-w,0):a+e;k(o,w)}},function(a){f.reject(a)}))},l=Wh(a,a,w),m=d?l.i:a,n=d?a-l.i+1:l.i+l.c-a;return k(m,n),j(f.promise(),{cancel:function(){i&&i.cancel(),h=!0}})},J=function(){C.onidle&&0===z&&C.onidle()},K=function(a){if(!p&&0!==x&&!v&&(0===m.length||m[0]&&-1!==m[0].c)){var b=new li(T,null,!0,a,x,null,x);L(b,m)}},L=function(a,b){a.oncomplete=G,b.push(a),z++,a.run(g)},M=function(a){var c=!1,d=j(new za,{cancel:function(){c=!0}}),e=P(d,"Read page from store failure");return B.contains(a,function(f){return c?void 0:f?void B.read(a,function(a,e){c||d.resolve(e!==b,e)},e):void d.resolve(!1)},e),d},N=function(a,b){var c=!1,d=j(new za,{cancel:function(){c=!0}}),e=P(d,"Save page to store failure"),f=function(){d.resolve(!0)};if(b.c>0){var g=Vh(b);v=q>=0&&n+g>q,v?f():B.addOrUpdate(a,b,function(){Q(b,g),O(f,e)},e)}else Q(b,0),O(f,e);return d},O=function(a,b){var c={actualCacheSize:n,allDataLocal:p,cacheSize:q,collectionCount:r,highestSavedPage:t,highestSavedPageSize:u,pageSize:w,sourceId:A.identifier,version:y};B.addOrUpdate("__settings",c,a,b)},P=function(a){return function(){a.resolve(!1)}},Q=function(a,b){var c=a.c,d=a.i;0===c?t===d-w&&(r=t+u):(t=Math.max(t,d),t===d&&(u=c),n+=b,w>c&&!r&&(r=d+c)),p||r!==t+u||(p=!0)},R=function(a,b,c,d){var e=a.canceled&&b!==ci;return e&&b===bi&&d&&d.cancel&&d.cancel(),e},S=function(a,b,c){var d=a.transition;if(c!==Xh)return E(Xh),!0;switch(b){case ei:d(gi);break;case ci:J();break;case gi:F().then(function(){a.complete()}),a.wait();break;default:return!1}return!0},T=function(a,b,c,d){if(!R(a,b,c,d)){var e=a.transition;if(c!==_h)return c===Xh?b!==bi&&a.cancel():c===Yh&&E(_h),!0;switch(b){case ei:m[0]===a&&e(ii,a.i);break;case hi:var f=a.pending;f>0&&(f-=Math.min(f,d.c)),p||0===f||d.c<w||v?a.complete():(a.pending=f,e(ii,d.i+w));break;default:return V(a,b,c,d,!0)}}return!0},U=function(a,b,c,d){if(!R(a,b,c,d)){var e=a.transition;if(c!==$h&&b!==ei)return c===Xh?b!==ei&&a.cancel():c!==ai&&E($h),!0;switch(b){case ei:if(c===Yh||c===_h)if(E($h),a.c>0){var f=Wh(a.i,a.c,w);e(ii,f.i)}else e(hi,a);break;case hi:Ph(a,d);var g=a.d.length;a.c===g||d.c<w?(h.cacheReads++,K(d.i+d.c),a.complete()):e(ii,d.i+w);break;default:return V(a,b,c,d,!1)}}return!0},V=function(a,b,c,d,e){var f,g=a.error,i=a.transition,j=a.wait;switch(b){case ci:J();break;case ii:f=M(d).then(function(b,c){a.canceled||(b?i(hi,c):i(ki,d))});break;case ki:f=H(d).then(function(b){a.canceled||(e?h.prefetches++:h.netReads++,i(ji,b))},g);break;case ji:c!==ai&&(E(ai),f=N(d.i,d).then(function(b){a.canceled||(!b&&e&&(a.pending=0),i(hi,d)),E(Yh)}));break;default:return!1}return f&&(a.canceled?f.cancel():a.s===b&&j(f)),!0};return B.read("__settings",function(a,b){if(f(b)){var c=b.version;if(!c||0!==c.indexOf("1."))return void D("Unsupported cache store version "+c)();w!==b.pageSize||A.identifier!==b.sourceId?F().then(function(){E(Yh)},D("Unable to clear store during initialization")):(n=b.actualCacheSize,p=b.allDataLocal,q=b.cacheSize,r=b.collectionCount,t=b.highestSavedPage,u=b.highestSavedPageSize,y=c,E(Yh))}else O(function(){E(Yh)},D("Unable to write settings during initialization."))},D("Unable to read settings from store.")),C};c.createDataCache=function(a){if(Sh(a.pageSize,"pageSize"),Th(a.cacheSize,"cacheSize"),Th(a.prefetchSize,"prefetchSize"),!f(a.name))throw{message:"Undefined or null name",options:a};if(!f(a.source))throw{message:"Undefined source",options:a};return new mi(a)}}(this),function(a){if(!a.adapter.get("OData1-3")){var b=a.$,c=a.utils,d=c.isString,e=c.createMapForArray,f=a.time,g=f.parseSFDateTime,h=f.parseDateTimeString,i=f.getSFDateTime,j=1,k=function(){return window.OData?b.Deferred().resolve().promise():c.loadJS(c.getStaticResourceUrl("DataJS","skuid",void 0,c.getCacheTimestamp()))},l=function(c){var d=b.Deferred(),f=c.service;if(f.metadata)d.resolve(f.metadata);else{var g=OData.defaultHttpClient,h={request:function(d,e,h){var i=d.service||f,j=i.createHTTPRequest({body:d.body,url:d.requestUri,headers:b.extend(d.headers,c.headers)});return i.useApexProxy?(i.authentication&&i.authentication.success&&(j.isAuthenticated=!0),a.ajax.proxy(j).done(function(a){if(a&&a.headers&&a.headers.DataServiceVersion&&"3.0"===a.headers.DataServiceVersion.slice(0,3)){var c=a.headers["Content-Type"];if(c&&"application/json"===c.slice(0,16)){var f=c.split(";"),g=!1;b.each(f,function(){return"odata"===this.slice(0,5)?(g=!0,!1):void 0}),g||(a.headers["Content-Type"]=c+";odata=minimalmetadata")}}var i={requestUri:d.requestUri,statusCode:a.statusCode,statusText:a.status,headers:a.headers,body:a.body};a.statusCode>=200&&a.statusCode<300?e(i):h(a.status,i)}).fail(function(){h()})):(b.extend(d,{requestUri:j.url,body:j.body,headers:j.headers}),g.request(d,function(a){e(a)},function(){h()}))}};OData.defaultHttpClient=h,OData.read({requestUri:f.serviceUrl+"/$metadata"},function(a,c){a&&a.dataServices?(e([a.dataServices],"schema","schemaMap","namespace",{addKeyRelationships:!1}),e(a.dataServices.schema,"association","associationMap","name",{addKeyRelationships:!1}),e(a.dataServices.schema,"entityContainer","entityContainerMap","name",{addKeyRelationships:!1}),e(a.dataServices.schema,"entityType","entityTypeMap","name",{addKeyRelationships:!1}),b.each(a.dataServices.schema,function(){var a=this;a.entityContainer&&(e(a.entityContainer,"associationSet","associationSetMap","name",{addKeyRelationships:!1}),e(a.entityContainer,"entitySet","entitySetMap","name",{addKeyRelationships:!1}),a.associationSetMap={},b.each(a.entityContainer,function(){b.extend(a.associationSetMap,this.associationSetMap)}),a.entitySetMap={},b.each(a.entityContainer,function(){b.extend(a.entitySetMap,this.entitySetMap)})),b.each(a.entityTypeMap,function(){this.__namespace=a.namespace})}),f.metadata=a,d.resolve(a)):d.reject(c.statusText+": "+c.body,c)},function(a,b){d.reject(a,b)},OData.metadataHandler)}return d.promise()},m=function(a){var c=b.Deferred();return a.service.authenticate().done(function(){n(a).done(function(a){c.resolve(a)}).fail(function(a,b){c.reject(a,b)})}).fail(function(a){c.reject(a)}),c.promise()},n=function(a){return k().then(function(){return l(a)})},o=function(b){var c,d,e;try{c=JSON.parse(b),d=c.error&&c.error.code,e=c.error&&c.error.message&&c.error.message.value}catch(f){}if(!c)try{c=a.utils.makeXMLDoc(b),d=c.find("code").text(),e=c.find("message").text()}catch(g){}return{code:d,message:e}},p=function(a){var b=a.split(".");return{name:b.pop(),nameSpace:b.join(".")}},q=function(a,c){var d=[];return b.each(a.dataServices.schemaMap,function(a,e){var f;if(c.entityContainer&&e.entityContainerMap){var g=e.entityContainerMap[c.entityContainer];f=g&&g.entitySetMap}else f=e.entitySetMap;f&&b.each(f,function(b){d.push(a+"."+b)})}),d},r=function(a,b){var c=p(a),d=b.dataServices.schemaMap[c.nameSpace].entitySetMap;return d&&d[c.name]},s=function(a,b){var c=p(a);return b.dataServices.schemaMap[c.nameSpace].entityTypeMap[c.name]},t=function(a,b){return s(a.entityType,b)},u=function(a){var c={},d=a.key;return d&&d.propertyRef&&b.each(d.propertyRef,function(b,d){c[d.name]={id:d.name,entityType:a}}),c},v=function(a,c){var d=c.key;return d?d.propertyRef.length>1?b.map(d.propertyRef,function(b){return b.name+"='"+a[b.name]+"'"}).join(","):a[d.propertyRef[0].name]+"":""+a.Id||a.ID||a.id},w=function(a,c,d,e){var f={},g=v(a,c,e);return b.each(d,function(b,c){f[c.id]=D(a,c,c.id)}),f.__metadata=a.__metadata,f.Id=g+"",f},x=function(a,b){var c=y(a.relationship,b),d=B(c,a.toRole);return d.type},y=function(a,b){var c=p(a);return b.dataServices.schemaMap[c.nameSpace].associationMap[c.name]},z=function(a,b,c){var d=[],e=c.dataServices.schemaMap[b].associationSetMap;for(var f in e)d.push(e[f]);return d.filter(function(b){return b.association===a})[0]},A=function(a,c){var d=[];return a.referentialConstraint&&b.each(a.referentialConstraint,function(a,e){e.role===c&&b.each(e.propertyRef,function(){d.push(this)})}),d},B=function(a,b){return a.end.filter(function(a){return a.role===b})[0]},C=function(a,b,c){var d=z(a.relationship,b,c);d||(d=y(a.relationship,c));var e=B(d,a.toRole);return e.entitySet&&b+"."+e.entitySet},D=function(a,b,c){var d,e=c.split(".");if(1===e.length){if("DATETIME"===b.displaytype){if(d=a[c]){var f;return f=d instanceof Date?d:h(d),i(f)}return null}return"Edm.Decimal"===b.edmtype||"Edm.Double"===b.edmtype?parseFloat(a[c]):"Edm.Int64"===b.edmtype?parseInt(a[c],10):a[c]}return d=a[e[0]],e.shift(),d?D(d,b,e.join(".")):null},E=function(e,f){var h,i=e.edmtype,j=c.adjustValueBasedOnQuotedness,k=function(a){return d(a)===!1?""+a:a};return"Edm.Binary"===i?f=window.btoa(f):-1!==b.inArray(i,["Edm.Boolean","Edm.Byte","Edm.Double","Edm.Int16","Edm.Int32","Edm.SByte","Edm.Single"])?f=j(f,!1):-1!==b.inArray(i,["Edm.Decimal","Edm.Guid","Edm.Int64","Edm.String"])?f=k(f):"Edm.DateTime"===i?(h=g(f),f=a.time.formatDate("yy-mm-ddT",h)+a.time.formatTime("HH:mm:ss.SSSZ",h)):"Edm.DateTimeOffset"===i&&(h=g(f),f=a.time.formatDate("yy-mm-ddT",h)+a.time.formatTime("HH:mm:ss.SSS000Z",h),f=f.slice(0,-2)+":"+f.slice(-2)),f},F=function(a,b,c,d,e){var f=a.split("."),g=b.property.concat(b.navigationProperty).filter(function(a){return a?f[0]===a.name:!1})[0];if(1===f.length)return g;var h=x(g,c),i=s(h,c);return d&&(d[(e&&e+"/"||"")+f.slice(0,f.length-1).join("/")]=!0),f.shift(),F(f.join("."),i)},G=function(a,b){return a.extensions?a.extensions.filter(function(a){return a.name===b}).length>0:!1},H=function(a,c,d,e,f,g){var h=p(c).nameSpace;if(e){var i={};b.each(e,function(a,b){i[b.id]=b}),b.each(u(a,d),function(a,b){i[b.id]||e.push(b)})}else e=[],a.property&&b.each(a.property,function(){e.push({id:this.name})}),a.navigationProperty&&b.each(a.navigationProperty,function(){e.push({id:this.name})});var j=function(a,c,e){if(a.uiOnly===!0)return a;var i=F(a.id,c,d,g,e&&e.id);if(i){var j=!G(i,"StoreGeneratedPattern"),k=a.id.split(".").join("/"),l={"Edm.String":"STRING","Edm.Boolean":"BOOLEAN","Edm.Date":"DATE","Edm.DateTime":"DATETIME","Edm.DateTimeOffset":"DATETIME","Edm.Int16":"NUMBER","Edm.Int32":"NUMBER","Edm.Decimal":"NUMBER","Edm.Double":"NUMBER","Edm.Int64":"NUMBER","Edm.Guid":"STRING"},m={id:a.id,accessible:!0,createable:j,editable:j,sortable:!0,label:i.name,displaytype:l[i.type]||i.type,edmtype:i.type};if(void 0!==e&&(k=e.id+"/"+k),f&&(f[k]=!0),i.fromRole){var n=y(i.relationship,d),o=B(n,i.toRole);if(m.rel=a.id,-1!==b.inArray(o.multiplicity,["0..1","1"])){var p=C(i,h,d);p||(n=y(i.relationship,d),p=B(n,i.toRole).type),m.displaytype="REFERENCE",m.ref=p,m.referenceTo=[{objectName:p}]}else{g&&(g[k]=!0),m.displaytype="ARRAY",m.type="array",m.dataPath="results",m.ref=o.type,m.referenceTo=[{objectName:o.type}],m.relationshipName=i.name,m.childSObject=o.type;var q=A(n,i.toRole);m.field=q.length&&q[0].name}}return"STRING"===m.displaytype&&(m.filterable=!0),a.overrideMetadata&&b.extend(m,a),m}};return b.map(e,function(c){var e=j(c,a),f=c.subFields||[];return f&&f.length>0&&(e.subFields=[],b.each(f,function(a,b){var f=s(e.ref,d);e.subFields.push(j(b,f,c))})),e})},I=function(a,d){var e="",f=b.map(a,function(a){var b=J(a);return void 0!==b?b:"!!"});return f.length&&(void 0===d&&(d=b.map(a,function(a,b){return a.inactive!==!0?b+1+"":void 0}).join(" AND ")),d&&(e=c.makeConditionLogicString(d,f,{customAndString:" and ",customOrString:" or "}),e=e.replace(/\(\)/g,""),-1!==e.indexOf("!!")&&(e=e.replace(/(((AND)|(OR)) ?!!)|(!! ?((AND)|(OR)))|!!|\(!!\)/gi,"").trim()))),e},J=function(a){var c=function(a,b){return a.field+" "+(b||"eq")+" "+(a.encloseValueInQuotes!==!1?"'":"")+a.value+(a.encloseValueInQuotes!==!1?"'":"")},d=function(a,b,c){var d=a.field.split(".").join("/"),e=(a.encloseValueInQuotes!==!1?"'":"")+a.value+(a.encloseValueInQuotes!==!1?"'":"");return b+"("+(c===!0?e:d)+","+(c===!0?d:e)+")"},e=function(a){var d=[],e=a.field;return b.each(a.values,function(){d.push("("+c({field:e,value:this,encloseValueInQuotes:a.encloseValueInQuotes},"eq")+")")}),"("+d.join(" or ")+")"},f={"=":function(a){return c(a,"eq")},"!=":function(a){return c(a,"ne")},gt:function(a){return c(a,"gt")},lt:function(a){return c(a,"lt")},gte:function(a){return c(a,"ge")},lte:function(a){return c(a,"le")},contains:function(a){return d(a,"substringof",!0)},"does not contain":function(a){return d(a,"not substringof",!0)},"starts with":function(a){return d(a,"startswith")},"does not start with":function(a){return d(a,"not startswith")},"ends with":function(a){return d(a,"endswith")},"does not end with":function(a){return d(a,"not endswith")},"in":function(a){return e(a)},"not in":function(a){return"not "+e(a)},">":function(a){return this.gt(a)},">=":function(a){return this.gte(a)},"<":function(a){return this.lt(a)},"<=":function(a){return this.lte(a)}};return a.inactive?"":"group"===a.type?I(a.subConditions,a.subConditionLogic):f[a.operator](a)},K={save:function(c,e){var f=b.Deferred();return m(e).then(function(g){var h=[];b.each(c.operations,function(c,d){var f=b.Deferred(),i=a.model.getModel(d.id),j=[],k=r(d.type,g),l=t(k,g),m=function(a,b,c){var d=i.getRowById(c),e=r(a.ref,g),f=s(e.entityType,g);return b?{__metadata:{uri:e.name+"("+b+")",id:d[a.id].__metadata.id,type:f.__namespace+"."+f.name}}:null};h.push(f),b.each(d.changes,function(a,c){var d={},e=a;K.isNewId(a)?(b.each(c,function(a,b){var c=i.getField(a);"REFERENCE"===c.displaytype?d[a]=m(c,b,e):d[a]=E(c,b)}),d.__metadata={type:l.__namespace+"."+l.name},j.push({requestUri:k.name,method:"POST",data:d,__oldid:a,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}})):c.__deleted?j.push({requestUri:k.name+"("+a+")",method:"DELETE",__oldid:a,headers:{"If-Match":"*",Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}}):(b.each(c,function(a,b){var c=i.getField(a);"REFERENCE"===c.displaytype?d[a]=m(c,b,e):d[a]=E(c,b)}),l.key?d[l.key.propertyRef[0].name]=a:d.ID=a,d.__metadata={type:l.__namespace+"."+l.name},j.push({requestUri:k.name+"("+a+")",method:"MERGE",data:d,__oldid:a,headers:{"If-Match":"*",Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"}}))}),OData.request({requestUri:e.service.serviceUrl+"/$batch",method:"POST",data:{__batchRequests:[{__changeRequests:j}]}},function(a,c){var e=[],h=[],k=[],m=!0,n=function(a,b){var c=j[b],f=[],n=a.data?w(a.data,l,i.fields,g):null,p=a.statusCode?a.statusCode.substring(0,1):"4";if(a instanceof Error&&(p="2"),"4"===p||"5"===p){var q="There was a problem with an OData Batch Request: ",r=o(a.response&&a.response.body);r&&(q+=(r.code?r.code+" - ":"")+r.message),f.push({fields:[],message:q,rowId:c.__oldid,severity:"ERROR",status:"OData Error"})}"MERGE"===c.method?k.push({errors:f,id:c.__oldid,messages:[],record:n&&JSON.stringify(n),source:d.id,success:!f.length}):"POST"===c.method?h.push({errors:f,id:n&&v(n,l,g),messages:[],oldId:c.__oldid,record:n&&JSON.stringify(n),source:d.id,success:!f.length}):"DELETE"===c.method&&e.push({errors:f,id:c.__oldid,messages:[],source:d.id,success:!f.length}),f.length&&(m=!1)},p=c.statusCode?(c.statusCode+"").substring(0,1):"4";"4"===p||"5"===p?f.reject(c.statusCode+" - "+c.statusText+" - "+c.body,c):(b.each(c.data.__batchResponses,function(a,c){c.__changeResponses?b.each(c.__changeResponses,function(a,b){n(b,a)}):n(c,a)}),f.resolve({deleteResults:e,globalErrors:[],insertResults:h,totalsuccess:m,updateResults:k}))},function(a,b){f.reject({message:"There was an error connecting to the proxy.",response:b})},OData.batchHandler)}),b.when.all(h).then(function(a){var c={insertResults:[],updateResults:[],deleteResults:[],globalErrors:[],totalsuccess:!0};b.each(a,function(a,d){b.merge(c.insertResults,d.insertResults),b.merge(c.updateResults,d.updateResults),b.merge(c.deleteResults,d.deleteResults),d.totalsuccess===!1&&(c.totalsuccess=!1)}),f.resolve(c)},function(a){var c=[],e=[];b.each(a,function(a,b){d(b.message)&&c.push(b.message),b.response&&e.push(b.response)}),f.reject(c,e)})}),f.promise()},load:function(a,c){var e=b.Deferred(),f=[];return m(b.extend({},c,{service:a[0].service})).then(function(g){b.each(a,function(){var a,d,e,h,i,j,k,l,m,n,o,p,q,s=this,u=b.Deferred(),v=s.objectName,x={},y={},z=[];return f.push(u.promise()),v?(d=r(v,g),e=t(d,g),h=H(e,v,g,s.fields,x,y),i=b.map(s.conditions,function(a){var b=s.getConditionValueResult(a);return a.originalValue||(a.originalValue=b.value),a}),j=Object.keys(y),k=Object.keys(x),j.length&&z.push("$expand="+j.join(",")),k.length&&z.push("$select="+k.join(",")),s.orderByClause&&z.push("$orderby="+s.orderByClause.replace(/nulls first/gi,"").replace(/nulls last/gi,"").replace(/asc/gi,"asc").replace(/desc/gi,"desc")),l=I(i,s.conditionLogic),l&&z.push("$filter="+l),m=s.offsetPageNumber,n=s.offsetPageSize,o=n||s.recordsLimit&&s.recordsLimit,m>1&&n>0&&z.push("$skip="+(m-1)*n),(0===o||o>0)&&z.push("$top="+(parseInt(o,10)+1)),a=s.service.serviceUrl+"/"+d.name,z.length&&(a+="?"+encodeURI(z.join("&"))),p={requestUri:a},c&&b.extend(!0,p,c),q={label:s.label||v,labelPlural:s.labelPlural||v,accessible:!0,createable:!0,updateable:!0,deleteable:!0,fields:h,conditions:i,soql:a,recordsLimit:o},void(s.doQuery===!1?u.resolve(q):OData.read(p,function(a){var c,d=!1;c=a.results?b.map(a.results,function(a){return w(a,e,h,g)}):[],o&&c.length>o&&(d=!0,c.pop()),b.extend(q,{data:c,canRetrieveMoreRows:d}),u.resolve(q)},function(a){u.reject(a)},void 0,void 0,g))):(u.reject("No object name specified for Model: "+s.id),!0)}),b.when.all(f).then(function(a){e.resolve(a)},function(a){var c="There was a problem with an OData Query: ";b.each(a,function(a,b){var e=o(b.response&&b.response.body);e&&b.response?c+=(e.code?e.code+" - ":"")+e.message+" - Request URL: "+b.response.requestUri:d(b)&&(c+=b)}),e.reject(c)})},function(a,b){e.reject(a,b)}),e.promise()},getObjectList:function(a){var c=b.Deferred();return m(a).then(function(b){c.resolve(q(b,a))},function(a,b){c.reject(a,b)}),c.promise()},buildEntityMetadataRequest:function(a){var b=a.targetEntity;return!b&&a.model&&a.model.attr&&(b=a.model.attr("sobject")),{objectName:b}},getEntityMetadataLoadingMessageFromBreadcrumb:function(a){return"Loading metadata for external object "+a.endsobject+"..."},getEntityMetadataCacheKey:function(a){return d(a)?a:a.objectName},getEntityMetadata:function(a){
var c=b.Deferred(),e=a.entities,f=function(a){return d(a)?a:a.objectName};return m(a).then(function(a){var d=[];b.each(e,function(b,e){var g,h,i,j=f(e);return j?(g=r(j,a),h=g?t(g,a):s(j,a),i=H(h,j,a),d.push({childRelationships:[],fields:i,label:j,labelPlural:j,objectName:j,readonly:!1}),void 0):(c.reject("No object name provided."),!1)}),c.resolve(d)},function(a,b){c.reject(a,b)}),c.promise()},isNewId:function(a){return"__skuidtemp"===a.substring(0,11)},getNewId:function(){return"__skuidtemp"+j++},getNameField:function(a){var b,c,d=a.service&&a.service.metadata,e="Id";return d&&(b=r(a.objectName,d),c=t(b,d),c.key&&c.key.propertyRef&&c.key.propertyRef.length&&(e=c.key.propertyRef[0].name)),e},properties:{composer:{supports:{childRelationships:!1},canFieldsBeSelected:function(a){return a.breadcrumb.endsobject?!0:"Select an external object for this Model."}},canAutoGenerateConditionsFromFields:!0,validConditionTypes:["fieldvalue","multiple","param","userinfo","blank","modelmerge"],canConditionsBeGrouped:!0},processFullyQualifiedName:function(a){return p(a)},name:"OData1-3"};new a.adapter.Adapter(K)}}(skuid);